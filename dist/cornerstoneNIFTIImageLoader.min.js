/*! cornerstone-nifti-image-loader - 0.0.1 - 2018-04-23 | (c) 2018 Flywheel Exchange, LLC | https://github.com/flywheel-io/cornerstone-nifti-image-loader */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cornerstoneNIFTIImageLoader",[],e):"object"==typeof exports?exports.cornerstoneNIFTIImageLoader=e():t.cornerstoneNIFTIImageLoader=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=15)}([function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var a in i)n(i,a)&&(t[a]=i[a])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,i,n,a){if(e.subarray&&t.subarray)return void t.set(e.subarray(i,i+n),a);for(var r=0;r<n;r++)t[a+r]=e[i+r]},flattenChunks:function(t){var e,i,n,a,r,s;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(s=new Uint8Array(n),a=0,e=0,i=t.length;e<i;e++)r=t[e],s.set(r,a),a+=r.length;return s}},s={arraySet:function(t,e,i,n,a){for(var r=0;r<n;r++)t[a+r]=e[i+r]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(a)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.external=void 0;var a=i(18),r=n(a),s=i(29),o=n(s),l=window.cornerstone,u=r.default,h={set cornerstone(t){l=t,(0,o.default)(l)},get cornerstone(){return l},set niftiReader(t){u=t},get niftiReader(){return u}};e.external=h},function(t,e,i){"use strict";var n=n||{};n.Utils=n.Utils||{},n.Utils.crcTable=null,n.Utils.GUNZIP_MAGIC_COOKIE1=31,n.Utils.GUNZIP_MAGIC_COOKIE2=139,n.Utils.getStringAt=function(t,e,i){var n,a,r="";for(n=e;n<i;n+=1)0!==(a=t.getUint8(n))&&(r+=String.fromCharCode(a));return r},n.Utils.getByteAt=function(t,e){return t.getInt8(e)},n.Utils.getShortAt=function(t,e,i){return t.getInt16(e,i)},n.Utils.getIntAt=function(t,e,i){return t.getInt32(e,i)},n.Utils.getFloatAt=function(t,e,i){return t.getFloat32(e,i)},n.Utils.getDoubleAt=function(t,e,i){return t.getFloat64(e,i)},n.Utils.getLongAt=function(t,e,i){var a,r=[],s=0;for(a=0;a<8;a+=1)r[a]=n.Utils.getByteAt(t,e+a,i);for(a=r.length-1;a>=0;a--)s=256*s+r[a];return s},n.Utils.toArrayBuffer=function(t){var e,i,n;for(e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n<t.length;n+=1)i[n]=t[n];return e},n.Utils.isString=function(t){return"string"==typeof t||t instanceof String},n.Utils.formatNumber=function(t,e){var i=0;return i=n.Utils.isString(t)?Number(t):t,i=e?i.toPrecision(5):i.toPrecision(7),parseFloat(i)},n.Utils.makeCRCTable=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e},n.Utils.crc32=function(t){for(var e=n.Utils.crcTable||(n.Utils.crcTable=n.Utils.makeCRCTable()),i=-1,a=0;a<t.byteLength;a++)i=i>>>8^e[255&(i^t.getUint8(a))];return(-1^i)>>>0},void 0!==t&&t.exports&&(t.exports=n.Utils)},function(t,e,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t){return void 0!==t}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e,i,a){var r=i.dimension,s=i.index;n(this,t),this.filePath=e,this.slice={dimension:r,index:s},this.timePoint=a}return r(t,[{key:"url",get:function(){var t="nifti:"+this.filePath;return(a(this.slice.dimension)||a(this.slice.index))&&(t+="#"),a(this.slice.dimension)&&(t+=this.slice.dimension,a(this.slice.index)&&(t+="-")),a(this.slice.index)&&(t+=this.slice.index),a(this.timePoint)&&(t+=",t-"+this.timePoint),t}}],[{key:"fromURL",value:function(e){var i=/^nifti:([^#]+)(?:#(?:(?=[xyz])(?:([xyz])(?:(?=-[\d]+)-([\d]+))?(?:,t-(\d+))?)|(?![xyz])([\d]+)))?$/,n=i.exec(e);if(!n)throw new Error("Not in a valid imageId format: "+e);return new t(n&&n[1],{dimension:n&&n[2]||"z",index:n&&parseInt(n[3]||n[5],0)||0},n&&n[4]&&parseInt(n[4],0)||0)}}]),t}();e.default=s},function(t,e,i){function n(t,e){return t[0]-e[0]}function a(){var t,e=this.stride,i=new Array(e.length);for(t=0;t<i.length;++t)i[t]=[Math.abs(e[t]),t];i.sort(n);var a=new Array(i.length);for(t=0;t<a.length;++t)a[t]=i[t][1];return a}function r(t,e){var i=["View",e,"d",t].join("");e<0&&(i="View_Nil"+t);var n="generic"===t;if(-1===e){var r="function "+i+"(a){this.data=a;};var proto="+i+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+i+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+i+"(a){return new "+i+"(a);}",s=new Function(r);return s()}if(0===e){var r="function "+i+"(a,d) {this.data = a;this.offset = d};var proto="+i+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+i+"_copy() {return new "+i+"(this.data,this.offset)};proto.pick=function "+i+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+i+"_get(){return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+i+"_set(v){return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+i+"(a,b,c,d){return new "+i+"(a,d)}",s=new Function("TrivialArray",r);return s(f[t][0])}var r=["'use strict'"],o=l(e),u=o.map(function(t){return"i"+t}),h="this.offset+"+o.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),d=o.map(function(t){return"b"+t}).join(","),c=o.map(function(t){return"c"+t}).join(",");r.push("function "+i+"(a,"+d+","+c+",d){this.data=a","this.shape=["+d+"]","this.stride=["+c+"]","this.offset=d|0}","var proto="+i+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),r.push("Object.defineProperty(proto,'size',{get:function "+i+"_size(){return "+o.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?r.push("proto.order=[0]"):(r.push("Object.defineProperty(proto,'order',{get:"),e<4?(r.push("function "+i+"_order(){"),2===e?r.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&r.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):r.push("ORDER})")),r.push("proto.set=function "+i+"_set("+u.join(",")+",v){"),n?r.push("return this.data.set("+h+",v)}"):r.push("return this.data["+h+"]=v}"),r.push("proto.get=function "+i+"_get("+u.join(",")+"){"),n?r.push("return this.data.get("+h+")}"):r.push("return this.data["+h+"]}"),r.push("proto.index=function "+i+"_index(",u.join(),"){return "+h+"}"),r.push("proto.hi=function "+i+"_hi("+u.join(",")+"){return new "+i+"(this.data,"+o.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+o.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var _=o.map(function(t){return"a"+t+"=this.shape["+t+"]"}),m=o.map(function(t){return"c"+t+"=this.stride["+t+"]"});r.push("proto.lo=function "+i+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+_.join(",")+","+m.join(","));for(var p=0;p<e;++p)r.push("if(typeof i"+p+"==='number'&&i"+p+">=0){d=i"+p+"|0;b+=c"+p+"*d;a"+p+"-=d}");r.push("return new "+i+"(this.data,"+o.map(function(t){return"a"+t}).join(",")+","+o.map(function(t){return"c"+t}).join(",")+",b)}"),r.push("proto.step=function "+i+"_step("+u.join(",")+"){var "+o.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+o.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var p=0;p<e;++p)r.push("if(typeof i"+p+"==='number'){d=i"+p+"|0;if(d<0){c+=b"+p+"*(a"+p+"-1);a"+p+"=ceil(-a"+p+"/d)}else{a"+p+"=ceil(a"+p+"/d)}b"+p+"*=d}");r.push("return new "+i+"(this.data,"+o.map(function(t){return"a"+t}).join(",")+","+o.map(function(t){return"b"+t}).join(",")+",c)}");for(var g=new Array(e),I=new Array(e),p=0;p<e;++p)g[p]="a[i"+p+"]",I[p]="b[i"+p+"]";r.push("proto.transpose=function "+i+"_transpose("+u+"){"+u.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+i+"(this.data,"+g.join(",")+","+I.join(",")+",this.offset)}"),r.push("proto.pick=function "+i+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var p=0;p<e;++p)r.push("if(typeof i"+p+"==='number'&&i"+p+">=0){c=(c+this.stride["+p+"]*i"+p+")|0}else{a.push(this.shape["+p+"]);b.push(this.stride["+p+"])}");r.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),r.push("return function construct_"+i+"(data,shape,stride,offset){return new "+i+"(data,"+o.map(function(t){return"shape["+t+"]"}).join(",")+","+o.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",r.join("\n"));return s(f[t],a)}function s(t){if(u(t))return"buffer";if(h)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function o(t,e,i,n){if(void 0===t){var a=f.array[0];return a([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var o=e.length;if(void 0===i){i=new Array(o);for(var l=o-1,u=1;l>=0;--l)i[l]=u,u*=e[l]}if(void 0===n){n=0;for(var l=0;l<o;++l)i[l]<0&&(n-=(e[l]-1)*i[l])}for(var h=s(t),d=f[h];d.length<=o+1;)d.push(r(h,d.length-1));var a=d[o+1];return a(t,e,i,n)}var l=i(37),u=i(38),h="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(7),r=n(a),s=i(16),o=i(30),l=n(o),u=i(4),h=n(u),f=i(46),d=n(f),c=i(14),_=n(c),m={headers:{}},p={loadImage:function(t){var e=void 0;try{var i=h.default.fromURL(t),n=l.default.getInstance(m.headers);_.default.imageLoadStart(i),e=n.acquire(i).then(function(t){return t.slice(i)}).then(function(t){return r.default.add(i.url,t.compoundMetaData),_.default.imageLoadEnd(i),t.cornerstoneImageObject})}catch(t){e=Promise.reject(t)}return e=(0,d.default)(e),e.promise=e,e},loadHeader:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=void 0;try{var n=h.default.fromURL(t),a=l.default.getInstance(m.headers);i=a.acquireHeaderOnly(n,e).then(function(t){return t.slice(n)}).then(function(t){return r.default.add(n.url,t.compoundMetaData),t.compoundMetaData})}catch(t){i=Promise.reject(t)}return i=(0,d.default)(i),i.promise=i,i},ImageId:h.default,register:function(t){t.registerImageLoader("nifti",this.loadImage),t.metaData.addProvider(s.metaDataProvider)},configure:function(t){Object.assign(m,t)}};e.default=p},function(t,e,i){"use strict";function n(t,e){o[t]=e}function a(t){return o[t]}function r(t){o[t]=void 0}function s(){o=[]}Object.defineProperty(e,"__esModule",{value:!0});var o=[];e.default={add:n,get:a,remove:r,purge:s}},function(t,e,i){"use strict";var n=n||{};n.Utils=n.Utils||i(2),n.NIFTI1=n.NIFTI1||function(){this.littleEndian=!1,this.dim_info=0,this.dims=[],this.intent_p1=0,this.intent_p2=0,this.intent_p3=0,this.intent_code=0,this.datatypeCode=0,this.numBitsPerVoxel=0,this.slice_start=0,this.slice_end=0,this.slice_code=0,this.pixDims=[],this.vox_offset=0,this.scl_slope=1,this.scl_inter=0,this.xyzt_units=0,this.cal_max=0,this.cal_min=0,this.slice_duration=0,this.toffset=0,this.description="",this.aux_file="",this.intent_name="",this.qform_code=0,this.sform_code=0,this.quatern_b=0,this.quatern_c=0,this.quatern_d=0,this.qoffset_x=0,this.qoffset_y=0,this.qoffset_z=0,this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this.magic=0,this.isHDR=!1,this.extensionFlag=[0,0,0,0],this.extensionSize=0,this.extensionCode=0},n.NIFTI1.TYPE_NONE=0,n.NIFTI1.TYPE_BINARY=1,n.NIFTI1.TYPE_UINT8=2,n.NIFTI1.TYPE_INT16=4,n.NIFTI1.TYPE_INT32=8,n.NIFTI1.TYPE_FLOAT32=16,n.NIFTI1.TYPE_COMPLEX64=32,n.NIFTI1.TYPE_FLOAT64=64,n.NIFTI1.TYPE_RGB24=128,n.NIFTI1.TYPE_INT8=256,n.NIFTI1.TYPE_UINT16=512,n.NIFTI1.TYPE_UINT32=768,n.NIFTI1.TYPE_INT64=1024,n.NIFTI1.TYPE_UINT64=1280,n.NIFTI1.TYPE_FLOAT128=1536,n.NIFTI1.TYPE_COMPLEX128=1792,n.NIFTI1.TYPE_COMPLEX256=2048,n.NIFTI1.XFORM_UNKNOWN=0,n.NIFTI1.XFORM_SCANNER_ANAT=1,n.NIFTI1.XFORM_ALIGNED_ANAT=2,n.NIFTI1.XFORM_TALAIRACH=3,n.NIFTI1.XFORM_MNI_152=4,n.NIFTI1.SPATIAL_UNITS_MASK=7,n.NIFTI1.TEMPORAL_UNITS_MASK=56,n.NIFTI1.UNITS_UNKNOWN=0,n.NIFTI1.UNITS_METER=1,n.NIFTI1.UNITS_MM=2,n.NIFTI1.UNITS_MICRON=3,n.NIFTI1.UNITS_SEC=8,n.NIFTI1.UNITS_MSEC=16,n.NIFTI1.UNITS_USEC=24,n.NIFTI1.UNITS_HZ=32,n.NIFTI1.UNITS_PPM=40,n.NIFTI1.UNITS_RADS=48,n.NIFTI1.MAGIC_COOKIE=348,n.NIFTI1.STANDARD_HEADER_SIZE=348,n.NIFTI1.MAGIC_NUMBER_LOCATION=344,n.NIFTI1.MAGIC_NUMBER=[110,43,49],n.NIFTI1.MAGIC_NUMBER2=[110,105,49],n.NIFTI1.EXTENSION_HEADER_SIZE=8,n.NIFTI1.prototype.readHeader=function(t){var e,i,a,r,s=new DataView(t),o=n.Utils.getIntAt(s,0,this.littleEndian);if(o!==n.NIFTI1.MAGIC_COOKIE&&(this.littleEndian=!0,o=n.Utils.getIntAt(s,0,this.littleEndian)),o!==n.NIFTI1.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=n.Utils.getByteAt(s,39),e=0;e<8;e+=1)r=40+2*e,this.dims[e]=n.Utils.getShortAt(s,r,this.littleEndian);for(this.intent_p1=n.Utils.getFloatAt(s,56,this.littleEndian),this.intent_p2=n.Utils.getFloatAt(s,60,this.littleEndian),this.intent_p3=n.Utils.getFloatAt(s,64,this.littleEndian),this.intent_code=n.Utils.getShortAt(s,68,this.littleEndian),this.datatypeCode=n.Utils.getShortAt(s,70,this.littleEndian),this.numBitsPerVoxel=n.Utils.getShortAt(s,72,this.littleEndian),this.slice_start=n.Utils.getShortAt(s,74,this.littleEndian),e=0;e<8;e+=1)r=76+4*e,this.pixDims[e]=n.Utils.getFloatAt(s,r,this.littleEndian);for(this.vox_offset=n.Utils.getFloatAt(s,108,this.littleEndian),this.scl_slope=n.Utils.getFloatAt(s,112,this.littleEndian),this.scl_inter=n.Utils.getFloatAt(s,116,this.littleEndian),this.slice_end=n.Utils.getShortAt(s,120,this.littleEndian),this.slice_code=n.Utils.getByteAt(s,122),this.xyzt_units=n.Utils.getByteAt(s,123),this.cal_max=n.Utils.getFloatAt(s,124,this.littleEndian),this.cal_min=n.Utils.getFloatAt(s,128,this.littleEndian),this.slice_duration=n.Utils.getFloatAt(s,132,this.littleEndian),this.toffset=n.Utils.getFloatAt(s,136,this.littleEndian),this.description=n.Utils.getStringAt(s,148,228),this.aux_file=n.Utils.getStringAt(s,228,252),this.qform_code=n.Utils.getShortAt(s,252,this.littleEndian),this.sform_code=n.Utils.getShortAt(s,254,this.littleEndian),this.quatern_b=n.Utils.getFloatAt(s,256,this.littleEndian),this.quatern_c=n.Utils.getFloatAt(s,260,this.littleEndian),this.quatern_d=n.Utils.getFloatAt(s,264,this.littleEndian),this.qoffset_x=n.Utils.getFloatAt(s,268,this.littleEndian),this.qoffset_y=n.Utils.getFloatAt(s,272,this.littleEndian),this.qoffset_z=n.Utils.getFloatAt(s,276,this.littleEndian),i=0;i<3;i+=1)for(a=0;a<4;a+=1)r=280+4*(4*i+a),this.affine[i][a]=n.Utils.getFloatAt(s,r,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=n.Utils.getStringAt(s,328,344),this.magic=n.Utils.getStringAt(s,344,348),this.isHDR=this.magic===n.NIFTI1.MAGIC_NUMBER2,s.byteLength>n.NIFTI1.MAGIC_COOKIE&&(this.extensionFlag[0]=n.Utils.getByteAt(s,348),this.extensionFlag[1]=n.Utils.getByteAt(s,349),this.extensionFlag[2]=n.Utils.getByteAt(s,350),this.extensionFlag[3]=n.Utils.getByteAt(s,351),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(s),this.extensionCode=this.getExtensionCode(s)))},n.NIFTI1.prototype.toFormattedString=function(){var t=n.Utils.formatNumber,e="";return e+="Dim Info = "+this.dim_info+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Intent Code = "+this.intent_code+"\n",e+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel = "+this.numBitsPerVoxel+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Slice End = "+this.slice_end+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(n.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(n.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+='Intent Name: "'+this.intent_name+'"\n',this.extensionFlag[0]&&(e+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+"\n"),e},n.NIFTI1.prototype.getDatatypeCodeString=function(t){return t===n.NIFTI1.TYPE_UINT8?"1-Byte Unsigned Integer":t===n.NIFTI1.TYPE_INT16?"2-Byte Signed Integer":t===n.NIFTI1.TYPE_INT32?"4-Byte Signed Integer":t===n.NIFTI1.TYPE_FLOAT32?"4-Byte Float":t===n.NIFTI1.TYPE_FLOAT64?"8-Byte Float":t===n.NIFTI1.TYPE_RGB24?"RGB":t===n.NIFTI1.TYPE_INT8?"1-Byte Signed Integer":t===n.NIFTI1.TYPE_UINT16?"2-Byte Unsigned Integer":t===n.NIFTI1.TYPE_UINT32?"4-Byte Unsigned Integer":t===n.NIFTI1.TYPE_INT64?"8-Byte Signed Integer":t===n.NIFTI1.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"},n.NIFTI1.prototype.getTransformCodeString=function(t){return t===n.NIFTI1.XFORM_SCANNER_ANAT?"Scanner":t===n.NIFTI1.XFORM_ALIGNED_ANAT?"Aligned":t===n.NIFTI1.XFORM_TALAIRACH?"Talairach":t===n.NIFTI1.XFORM_MNI_152?"MNI":"Unknown"},n.NIFTI1.prototype.getUnitsCodeString=function(t){return t===n.NIFTI1.UNITS_METER?"Meters":t===n.NIFTI1.UNITS_MM?"Millimeters":t===n.NIFTI1.UNITS_MICRON?"Microns":t===n.NIFTI1.UNITS_SEC?"Seconds":t===n.NIFTI1.UNITS_MSEC?"Milliseconds":t===n.NIFTI1.UNITS_USEC?"Microseconds":t===n.NIFTI1.UNITS_HZ?"Hz":t===n.NIFTI1.UNITS_PPM?"PPM":t===n.NIFTI1.UNITS_RADS?"Rads":"Unknown"},n.NIFTI1.prototype.getQformMat=function(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])},n.NIFTI1.prototype.convertNiftiQFormToNiftiSForm=function(t,e,i,n,a,r,s,o,l,u){var h,f,d,c,_=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],m=t,p=e,g=i;return _[3][0]=_[3][1]=_[3][2]=0,_[3][3]=1,h=1-(m*m+p*p+g*g),h<1e-7?(h=1/Math.sqrt(m*m+p*p+g*g),m*=h,p*=h,g*=h,h=0):h=Math.sqrt(h),f=s>0?s:1,d=o>0?o:1,c=l>0?l:1,u<0&&(c=-c),_[0][0]=(h*h+m*m-p*p-g*g)*f,_[0][1]=2*(m*p-h*g)*d,_[0][2]=2*(m*g+h*p)*c,_[1][0]=2*(m*p+h*g)*f,_[1][1]=(h*h+p*p-m*m-g*g)*d,_[1][2]=2*(p*g-h*m)*c,_[2][0]=2*(m*g-h*p)*f,_[2][1]=2*(p*g+h*m)*d,_[2][2]=(h*h+g*g-p*p-m*m)*c,_[0][3]=n,_[1][3]=a,_[2][3]=r,_},n.NIFTI1.prototype.convertNiftiSFormToNEMA=function(t){var e,i,n,a,r,s,o,l,u,h,f,d,c,_,m,p,g,I,v,b,y,w,T,x,N,F,k,E,A,P,S,D,U;if(_=0,F=[[0,0,0],[0,0,0],[0,0,0]],k=[[0,0,0],[0,0,0],[0,0,0]],e=t[0][0],i=t[0][1],n=t[0][2],a=t[1][0],r=t[1][1],s=t[1][2],o=t[2][0],l=t[2][1],u=t[2][2],0===(h=Math.sqrt(e*e+a*a+o*o)))return null;if(e/=h,a/=h,o/=h,0===(h=Math.sqrt(i*i+r*r+l*l)))return null;if(i/=h,r/=h,l/=h,h=e*i+a*r+o*l,Math.abs(h)>1e-4){if(i-=h*e,r-=h*a,l-=h*o,0===(h=Math.sqrt(i*i+r*r+l*l)))return null;i/=h,r/=h,l/=h}if(h=Math.sqrt(n*n+s*s+u*u),0===h?(n=a*l-o*r,s=o*i-l*e,u=e*r-a*i):(n/=h,s/=h,u/=h),h=e*n+a*s+o*u,Math.abs(h)>1e-4){if(n-=h*e,s-=h*a,u-=h*o,0===(h=Math.sqrt(n*n+s*s+u*u)))return null;n/=h,s/=h,u/=h}if(h=i*n+r*s+l*u,Math.abs(h)>1e-4){if(n-=h*i,s-=h*r,u-=h*l,0===(h=Math.sqrt(n*n+s*s+u*u)))return null;n/=h,s/=h,u/=h}if(F[0][0]=e,F[0][1]=i,F[0][2]=n,F[1][0]=a,F[1][1]=r,F[1][2]=s,F[2][0]=o,F[2][1]=l,F[2][2]=u,0===(f=this.nifti_mat33_determ(F)))return null;for(N=-666,I=y=w=T=1,v=2,b=3,d=1;d<=3;d+=1)for(c=1;c<=3;c+=1)if(d!==c)for(_=1;_<=3;_+=1)if(d!==_&&c!==_)for(k[0][0]=k[0][1]=k[0][2]=k[1][0]=k[1][1]=k[1][2]=k[2][0]=k[2][1]=k[2][2]=0,m=-1;m<=1;m+=2)for(p=-1;p<=1;p+=2)for(g=-1;g<=1;g+=2)k[0][d-1]=m,k[1][c-1]=p,k[2][_-1]=g,this.nifti_mat33_determ(k)*f>0&&(x=this.nifti_mat33_mul(k,F),(h=x[0][0]+x[1][1]+x[2][2])>N&&(N=h,I=d,v=c,b=_,y=m,w=p,T=g));switch(E=A=P=S=D=U=0,I*y){case 1:E="X",S="+";break;case-1:E="X",S="-";break;case 2:E="Y",S="+";break;case-2:E="Y",S="-";break;case 3:E="Z",S="+";break;case-3:E="Z",S="-"}switch(v*w){case 1:A="X",D="+";break;case-1:A="X",D="-";break;case 2:A="Y",D="+";break;case-2:A="Y",D="-";break;case 3:A="Z",D="+";break;case-3:A="Z",D="-"}switch(b*T){case 1:P="X",U="+";break;case-1:P="X",U="-";break;case 2:P="Y",U="+";break;case-2:P="Y",U="-";break;case 3:P="Z",U="+";break;case-3:P="Z",U="-"}return E+A+P+S+D+U},n.NIFTI1.prototype.nifti_mat33_mul=function(t,e){var i,n,a=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;i<3;i+=1)for(n=0;n<3;n+=1)a[i][n]=t[i][0]*e[0][n]+t[i][1]*e[1][n]+t[i][2]*e[2][n];return a},n.NIFTI1.prototype.nifti_mat33_determ=function(t){var e,i,n,a,r,s,o,l,u;return e=t[0][0],i=t[0][1],n=t[0][2],a=t[1][0],r=t[1][1],s=t[1][2],o=t[2][0],l=t[2][1],u=t[2][2],e*r*u-e*l*s-a*i*u+a*l*n+o*i*s-o*r*n},n.NIFTI1.prototype.getExtensionLocation=function(){return n.NIFTI1.MAGIC_COOKIE+4},n.NIFTI1.prototype.getExtensionSize=function(t){return n.Utils.getIntAt(t,this.getExtensionLocation(),this.littleEndian)},n.NIFTI1.prototype.getExtensionCode=function(t){return n.Utils.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)},void 0!==t&&t.exports&&(t.exports=n.NIFTI1)},function(t,e,i){"use strict";function n(t,e,i,n){for(var a=65535&t|0,r=t>>>16&65535|0,s=0;0!==i;){s=i>2e3?2e3:i,i-=s;do{a=a+e[n++]|0,r=r+a|0}while(--s);a%=65521,r%=65521}return a|r<<16|0}t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n){var r=a,s=n+i;t^=-1;for(var o=n;o<s;o++)t=t>>>8^r[255&(t^e[o])];return-1^t}var a=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=n},function(t,e,i){"use strict";function n(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&r))return String.fromCharCode.apply(null,a.shrinkBuf(t,e));for(var i="",n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i}var a=i(0),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var o=new a.Buf8(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1,e.string2buf=function(t){var e,i,n,r,s,o=t.length,l=0;for(r=0;r<o;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&56320==(64512&(n=t.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=new a.Buf8(l),s=0,r=0;s<l;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&56320==(64512&(n=t.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},e.buf2binstring=function(t){return n(t,t.length)},e.binstring2buf=function(t){for(var e=new a.Buf8(t.length),i=0,n=e.length;i<n;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,a,r,s,l=e||t.length,u=new Array(2*l);for(a=0,i=0;i<l;)if((r=t[i++])<128)u[a++]=r;else if((s=o[r])>4)u[a++]=65533,i+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&i<l;)r=r<<6|63&t[i++],s--;s>1?u[a++]=65533:r<65536?u[a++]=r:(r-=65536,u[a++]=55296|r>>10&1023,u[a++]=56320|1023&r)}return n(u,a)},e.utf8border=function(t,e){var i;for(e=e||t.length,e>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+o[t[i]]>e?i:e}},function(t,e,i){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},function(t,e,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={detail:e},n=new CustomEvent(t,i);a.external.cornerstone.events.dispatchEvent(n)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1);e.default={imageLoadProgress:function(t){return n("cornerstoneimageloadprogress",t)},imageLoadStart:function(t){return n("cornerstoneimageloadstart",t)},imageLoadEnd:function(t){return n("cornerstoneimageloadend",t)}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(6);Object.defineProperty(e,"nifti",{enumerable:!0,get:function(){return n(a).default}});var r=i(1);Object.defineProperty(e,"external",{enumerable:!0,get:function(){return r.external}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var i=g.niftiReader,n=g.metaDataManager,a=n.get(e);if(a){var h=p.default.fromURL(e);switch(t){case"functional":return{frameOfReferenceUID:h.filePath,timeSlices:a.timeSlices};case"imagePlane":case"imagePlaneModule":return{frameOfReferenceUID:h.filePath,columns:a.columns,rows:a.rows,imageOrientationPatient:a.imageOrientationPatient,columnCosines:a.columnCosines,rowCosines:a.rowCosines,imagePositionPatient:a.imagePositionPatient,sliceThickness:a.slicePixelSpacing,columnPixelSpacing:a.columnPixelSpacing,rowPixelSpacing:a.rowPixelSpacing};case"imagePixel":case"imagePixelModule":return{samplesPerPixel:r(a),photometricInterpretation:s(a,i),rows:a.rows,columns:a.columns,bitsAllocated:a.header.numBitsPerVoxel,bitsStored:a.header.numBitsPerVoxel,highBit:a.header.numBitsPerVoxel-1,pixelRepresentation:o(a,i),planarConfiguration:l(a),pixelAspectRatio:u(a),smallestPixelValue:a.minPixelValue,largestPixelValue:a.maxPixelValue};case"modalityLut":case"modalityLutModule":return{rescaleIntercept:a.intercept,rescaleSlope:a.slope,rescaleType:"US",modalityLutSequence:void 0};case"voiLut":case"voiLutModule":return{windowCenter:a.windowCenter,windowWidth:a.windowWidth,voiLutSequence:void 0};case"multiFrame":case"multiFrameModule":return{numberOfFrames:a.numberOfFrames,frameIncrementPointer:void 0,stereoPairsPresent:"NO"};default:return}}}function r(t){return t.header.dims[0]>=5&&t.header.dims[5]>1?t.header.dims[5]:1}function s(t,e){var i=t.header.datatypeCode,n=r(t),a=i===e.NIFTI1.TYPE_RGB&&3===n,s=i===e.NIFTI1.TYPE_RGBA&&4===n;return a||s?"RGB":"MONOCHROME2"}function o(t,e){switch(t.header.datatypeCode){case e.NIFTI1.TYPE_UINT8:case e.NIFTI1.TYPE_UINT16:case e.NIFTI1.TYPE_UINT32:case e.NIFTI1.TYPE_UINT64:return"0000H";case e.NIFTI1.TYPE_INT8:case e.NIFTI1.TYPE_INT16:case e.NIFTI1.TYPE_INT32:case e.NIFTI1.TYPE_INT64:return"0001H";case e.NIFTI1.TYPE_FLOAT32:case e.NIFTI1.TYPE_FLOAT64:case e.NIFTI1.TYPE_RGB:case e.NIFTI1.TYPE_RGBA:return"0000H"}}function l(t){return r(t)>1?0:void 0}function u(t){var e=g.decimalToFraction,i=t.header.pixDims[1],n=t.header.pixDims[2],a=e(n/i);return a.numerator+"/"+a.denominator}function h(t){var e=t.metaDataManager,i=t.decimalToFraction,n=t.niftiReader;return g.metaDataManager=e,g.decimalToFraction=i,g.niftiReader=n,a}Object.defineProperty(e,"__esModule",{value:!0}),e.metaDataProvider=a,e.metaDataProviderBuilder=h;var f=i(7),d=n(f),c=i(17),_=i(1),m=i(4),p=n(m),g={metaDataManager:d.default,decimalToFraction:c.decimalToFraction,niftiReader:_.external.niftiReader}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t){if("number"!=typeof t||t instanceof Number)throw new Error("The provided argument ("+t+") is not a number.");var e=new l(t,1);if(r(t)){var i=s(t,9),n=Math.pow(10,i.toString().split(".")[1].length);e.numerator=Math.round(e.numerator*n),e.denominator*=n}var a=o(e.numerator,e.denominator);return e.numerator/=a,e.denominator/=a,e}function r(t){var e=t,i=e%1>0&&e%1<1,n=e%-1<0&&e%-1>-1;return e>0&&i||e<0&&n}function s(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}function o(t,e){if(!("number"==typeof t||t instanceof Number)||!("number"==typeof e||e instanceof Number))throw new Error("Greatest common factor requires 2 numbers to compute. What was provided: "+t+" and "+e+".");t=Math.abs(t),e=Math.abs(e);for(var i=void 0;e;)i=t%e,t=e,e=i;return t}Object.defineProperty(e,"__esModule",{value:!0});var l=function t(e,i){n(this,t),this.numerator=e,this.denominator=i};e.decimalToFraction=a,e.hasDecimalPoint=r,e.roundToPlaces=s,e.gcf=o},function(t,e,i){"use strict";var n=n||{};n.NIFTI1=n.NIFTI1||i(8),n.NIFTI2=n.NIFTI2||i(19),n.Utils=n.Utils||i(2);var a=a||i(20);n.isNIFTI1=function(t){var e,i,a,r;return!(t.byteLength<n.NIFTI1.STANDARD_HEADER_SIZE)&&(e=new DataView(t),e&&(i=e.getUint8(n.NIFTI1.MAGIC_NUMBER_LOCATION)),a=e.getUint8(n.NIFTI1.MAGIC_NUMBER_LOCATION+1),r=e.getUint8(n.NIFTI1.MAGIC_NUMBER_LOCATION+2),!(i!==n.NIFTI1.MAGIC_NUMBER[0]||a!==n.NIFTI1.MAGIC_NUMBER[1]||r!==n.NIFTI1.MAGIC_NUMBER[2]))},n.isNIFTI2=function(t){var e,i,a,r;return!(t.byteLength<n.NIFTI1.STANDARD_HEADER_SIZE)&&(e=new DataView(t),i=e.getUint8(n.NIFTI2.MAGIC_NUMBER_LOCATION),a=e.getUint8(n.NIFTI2.MAGIC_NUMBER_LOCATION+1),r=e.getUint8(n.NIFTI2.MAGIC_NUMBER_LOCATION+2),!(i!==n.NIFTI2.MAGIC_NUMBER[0]||a!==n.NIFTI2.MAGIC_NUMBER[1]||r!==n.NIFTI2.MAGIC_NUMBER[2]))},n.isNIFTI=function(t){return n.isNIFTI1(t)||n.isNIFTI2(t)},n.isCompressed=function(t){var e,i,a;if(t){if(e=new DataView(t),i=e.getUint8(0),a=e.getUint8(1),i===n.Utils.GUNZIP_MAGIC_COOKIE1)return!0;if(a===n.Utils.GUNZIP_MAGIC_COOKIE2)return!0}return!1},n.decompress=function(t){return a.inflate(t).buffer},n.readHeader=function(t){var e=null;return n.isCompressed(t)&&(t=n.decompress(t)),n.isNIFTI1(t)?e=new n.NIFTI1:n.isNIFTI2(t)&&(e=new n.NIFTI2),e?e.readHeader(t):console.error("That file does not appear to be NIFTI!"),e},n.hasExtension=function(t){return 0!=t.extensionFlag[0]},n.readImage=function(t,e){var i=t.vox_offset,n=1,a=1;t.dims[4]&&(n=t.dims[4]),t.dims[5]&&(a=t.dims[5]);var r=t.dims[1]*t.dims[2]*t.dims[3]*n*a*(t.numBitsPerVoxel/8);return e.slice(i,i+r)},n.readExtension=function(t,e){var i=t.getExtensionLocation(),n=t.extensionSize;return e.slice(i,i+n)},n.readExtensionData=function(t,e){var i=t.getExtensionLocation(),n=t.extensionSize;return e.slice(i+8,i+n-8)},void 0!==t&&t.exports&&(t.exports=n)},function(t,e,i){"use strict";var n=n||{};n.Utils=n.Utils||i(2),n.NIFTI1=n.NIFTI1||i(8),n.NIFTI2=n.NIFTI2||function(){this.littleEndian=!1,this.dim_info=0,this.dims=[],this.intent_p1=0,this.intent_p2=0,this.intent_p3=0,this.intent_code=0,this.datatypeCode=0,this.numBitsPerVoxel=0,this.slice_start=0,this.slice_end=0,this.slice_code=0,this.pixDims=[],this.vox_offset=0,this.scl_slope=1,this.scl_inter=0,this.xyzt_units=0,this.cal_max=0,this.cal_min=0,this.slice_duration=0,this.toffset=0,this.description="",this.aux_file="",this.intent_name="",this.qform_code=0,this.sform_code=0,this.quatern_b=0,this.quatern_c=0,this.quatern_d=0,this.qoffset_x=0,this.qoffset_y=0,this.qoffset_z=0,this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this.magic=0,this.extensionFlag=[0,0,0,0]},n.NIFTI2.MAGIC_COOKIE=540,n.NIFTI2.MAGIC_NUMBER_LOCATION=4,n.NIFTI2.MAGIC_NUMBER=[110,43,50,0,13,10,26,10],n.NIFTI2.prototype.readHeader=function(t){var e,i,a,r,s=new DataView(t),o=n.Utils.getIntAt(s,0,this.littleEndian);if(o!==n.NIFTI2.MAGIC_COOKIE&&(this.littleEndian=!0,o=n.Utils.getIntAt(s,0,this.littleEndian)),o!==n.NIFTI2.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.datatypeCode=n.Utils.getShortAt(s,12,this.littleEndian),this.numBitsPerVoxel=n.Utils.getShortAt(s,14,this.littleEndian),e=0;e<8;e+=1)r=16+8*e,this.dims[e]=n.Utils.getLongAt(s,r,this.littleEndian);for(this.intent_p1=n.Utils.getDoubleAt(s,80,this.littleEndian),this.intent_p2=n.Utils.getDoubleAt(s,88,this.littleEndian),this.intent_p3=n.Utils.getDoubleAt(s,96,this.littleEndian),e=0;e<8;e+=1)r=104+8*e,this.pixDims[e]=n.Utils.getDoubleAt(s,r,this.littleEndian);for(this.vox_offset=n.Utils.getLongAt(s,168,this.littleEndian),this.scl_slope=n.Utils.getDoubleAt(s,176,this.littleEndian),this.scl_inter=n.Utils.getDoubleAt(s,184,this.littleEndian),this.cal_max=n.Utils.getDoubleAt(s,192,this.littleEndian),this.cal_min=n.Utils.getDoubleAt(s,200,this.littleEndian),this.slice_duration=n.Utils.getDoubleAt(s,208,this.littleEndian),this.toffset=n.Utils.getDoubleAt(s,216,this.littleEndian),this.slice_start=n.Utils.getLongAt(s,224,this.littleEndian),this.slice_end=n.Utils.getLongAt(s,232,this.littleEndian),this.description=n.Utils.getStringAt(s,240,320),this.aux_file=n.Utils.getStringAt(s,320,344),this.qform_code=n.Utils.getIntAt(s,344,this.littleEndian),this.sform_code=n.Utils.getIntAt(s,348,this.littleEndian),this.quatern_b=n.Utils.getDoubleAt(s,352,this.littleEndian),this.quatern_c=n.Utils.getDoubleAt(s,360,this.littleEndian),this.quatern_d=n.Utils.getDoubleAt(s,368,this.littleEndian),this.qoffset_x=n.Utils.getDoubleAt(s,376,this.littleEndian),this.qoffset_y=n.Utils.getDoubleAt(s,384,this.littleEndian),this.qoffset_z=n.Utils.getDoubleAt(s,392,this.littleEndian),i=0;i<3;i+=1)for(a=0;a<4;a+=1)r=400+8*(4*i+a),this.affine[i][a]=n.Utils.getDoubleAt(s,r,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=n.Utils.getIntAt(s,496,this.littleEndian),this.xyzt_units=n.Utils.getIntAt(s,500,this.littleEndian),this.intent_code=n.Utils.getIntAt(s,504,this.littleEndian),this.intent_name=n.Utils.getStringAt(s,508,524),this.dim_info=n.Utils.getByteAt(s,524),s.byteLength>n.NIFTI2.MAGIC_COOKIE&&(this.extensionFlag[0]=n.Utils.getByteAt(s,540),this.extensionFlag[1]=n.Utils.getByteAt(s,541),this.extensionFlag[2]=n.Utils.getByteAt(s,542),this.extensionFlag[3]=n.Utils.getByteAt(s,543),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(s),this.extensionCode=this.getExtensionCode(s)))},n.NIFTI2.prototype.toFormattedString=function(){var t=n.Utils.formatNumber,e="";return e+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel =  = "+this.numBitsPerVoxel+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Slice End = "+this.slice_end+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(n.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(n.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Intent Code = "+this.intent_code+"\n",e+='Intent Name: "'+this.intent_name+'"\n',e+="Dim Info = "+this.dim_info+"\n"},n.NIFTI2.prototype.getExtensionLocation=function(){return n.NIFTI2.MAGIC_COOKIE+4},n.NIFTI2.prototype.getExtensionSize=n.NIFTI1.prototype.getExtensionSize,n.NIFTI2.prototype.getExtensionCode=n.NIFTI1.prototype.getExtensionCode,n.NIFTI2.prototype.getDatatypeCodeString=n.NIFTI1.prototype.getDatatypeCodeString,n.NIFTI2.prototype.getTransformCodeString=n.NIFTI1.prototype.getTransformCodeString,n.NIFTI2.prototype.getUnitsCodeString=n.NIFTI1.prototype.getUnitsCodeString,n.NIFTI2.prototype.getQformMat=n.NIFTI1.prototype.getQformMat,n.NIFTI2.prototype.convertNiftiQFormToNiftiSForm=n.NIFTI1.prototype.convertNiftiQFormToNiftiSForm,n.NIFTI2.prototype.convertNiftiSFormToNEMA=n.NIFTI1.prototype.convertNiftiSFormToNEMA,n.NIFTI2.prototype.nifti_mat33_mul=n.NIFTI1.prototype.nifti_mat33_mul,n.NIFTI2.prototype.nifti_mat33_determ=n.NIFTI1.prototype.nifti_mat33_determ,void 0!==t&&t.exports&&(t.exports=n.NIFTI2)},function(t,e,i){"use strict";var n=i(0).assign,a=i(21),r=i(24),s=i(13),o={};n(o,a,r,s),t.exports=o},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=l.assign({level:_,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var i=o.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==c)throw new Error(h[i]);if(e.header&&o.deflateSetHeader(this.strm,e.header),e.dictionary){var a;if(a="string"==typeof e.dictionary?u.string2buf(e.dictionary):"[object ArrayBuffer]"===d.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=o.deflateSetDictionary(this.strm,a))!==c)throw new Error(h[i]);this._dict_set=!0}}function a(t,e){var i=new n(e);if(i.push(t,!0),i.err)throw i.msg||h[i.err];return i.result}function r(t,e){return e=e||{},e.raw=!0,a(t,e)}function s(t,e){return e=e||{},e.gzip=!0,a(t,e)}var o=i(22),l=i(0),u=i(11),h=i(3),f=i(12),d=Object.prototype.toString,c=0,_=-1,m=0,p=8;n.prototype.push=function(t,e){var i,n,a=this.strm,r=this.options.chunkSize;if(this.ended)return!1;n=e===~~e?e:!0===e?4:0,"string"==typeof t?a.input=u.string2buf(t):"[object ArrayBuffer]"===d.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new l.Buf8(r),a.next_out=0,a.avail_out=r),1!==(i=o.deflate(a,n))&&i!==c)return this.onEnd(i),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(u.buf2binstring(l.shrinkBuf(a.output,a.next_out))):this.onData(l.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==i);return 4===n?(i=o.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==n||(this.onEnd(c),a.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=n,e.deflate=a,e.deflateRaw=r,e.gzip=s},function(t,e,i){"use strict";function n(t,e){return t.msg=C[e],e}function a(t){return(t<<1)-(t>4?9:0)}function r(t){for(var e=t.length;--e>=0;)t[e]=0}function s(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(P.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function o(t,e){S._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,s(t.strm)}function l(t,e){t.pending_buf[t.pending++]=e}function u(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function h(t,e,i,n){var a=t.avail_in;return a>n&&(a=n),0===a?0:(t.avail_in-=a,P.arraySet(e,t.input,t.next_in,a,i),1===t.state.wrap?t.adler=D(t.adler,e,a,i):2===t.state.wrap&&(t.adler=U(t.adler,e,a,i)),t.next_in+=a,t.total_in+=a,a)}function f(t,e){var i,n,a=t.max_chain_length,r=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-ut?t.strstart-(t.w_size-ut):0,u=t.window,h=t.w_mask,f=t.prev,d=t.strstart+lt,c=u[r+s-1],_=u[r+s];t.prev_length>=t.good_match&&(a>>=2),o>t.lookahead&&(o=t.lookahead);do{if(i=e,u[i+s]===_&&u[i+s-1]===c&&u[i]===u[r]&&u[++i]===u[r+1]){r+=2,i++;do{}while(u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&u[++r]===u[++i]&&r<d);if(n=lt-(d-r),r=d-lt,n>s){if(t.match_start=e,s=n,n>=o)break;c=u[r+s-1],_=u[r+s]}}}while((e=f[e&h])>l&&0!=--a);return s<=t.lookahead?s:t.lookahead}function d(t){var e,i,n,a,r,s=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-ut)){P.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,i=t.hash_size,e=i;do{n=t.head[--e],t.head[e]=n>=s?n-s:0}while(--i);i=s,e=i;do{n=t.prev[--e],t.prev[e]=n>=s?n-s:0}while(--i);a+=s}if(0===t.strm.avail_in)break;if(i=h(t.strm,t.window,t.strstart+t.lookahead,a),t.lookahead+=i,t.lookahead+t.insert>=ot)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+ot-1])&t.hash_mask,t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<ot)););}while(t.lookahead<ut&&0!==t.strm.avail_in)}function c(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(d(t),0===t.lookahead&&e===O)return It;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,o(t,!1),0===t.strm.avail_out))return It;if(t.strstart-t.block_start>=t.w_size-ut&&(o(t,!1),0===t.strm.avail_out))return It}return t.insert=0,e===B?(o(t,!0),0===t.strm.avail_out?bt:yt):(t.strstart>t.block_start&&(o(t,!1),t.strm.avail_out),It)}function _(t,e){for(var i,n;;){if(t.lookahead<ut){if(d(t),t.lookahead<ut&&e===O)return It;if(0===t.lookahead)break}if(i=0,t.lookahead>=ot&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+ot-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-ut&&(t.match_length=f(t,i)),t.match_length>=ot)if(n=S._tr_tally(t,t.strstart-t.match_start,t.match_length-ot),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=ot){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+ot-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=S._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(o(t,!1),0===t.strm.avail_out))return It}return t.insert=t.strstart<ot-1?t.strstart:ot-1,e===B?(o(t,!0),0===t.strm.avail_out?bt:yt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?It:vt}function m(t,e){for(var i,n,a;;){if(t.lookahead<ut){if(d(t),t.lookahead<ut&&e===O)return It;if(0===t.lookahead)break}if(i=0,t.lookahead>=ot&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+ot-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=ot-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-ut&&(t.match_length=f(t,i),t.match_length<=5&&(t.strategy===V||t.match_length===ot&&t.strstart-t.match_start>4096)&&(t.match_length=ot-1)),t.prev_length>=ot&&t.match_length<=t.prev_length){a=t.strstart+t.lookahead-ot,n=S._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-ot),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=a&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+ot-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=ot-1,t.strstart++,n&&(o(t,!1),0===t.strm.avail_out))return It}else if(t.match_available){if(n=S._tr_tally(t,0,t.window[t.strstart-1]),n&&o(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return It}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=S._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<ot-1?t.strstart:ot-1,e===B?(o(t,!0),0===t.strm.avail_out?bt:yt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?It:vt}function p(t,e){for(var i,n,a,r,s=t.window;;){if(t.lookahead<=lt){if(d(t),t.lookahead<=lt&&e===O)return It;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=ot&&t.strstart>0&&(a=t.strstart-1,(n=s[a])===s[++a]&&n===s[++a]&&n===s[++a])){r=t.strstart+lt;do{}while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<r);t.match_length=lt-(r-a),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=ot?(i=S._tr_tally(t,1,t.match_length-ot),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=S._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(o(t,!1),0===t.strm.avail_out))return It}return t.insert=0,e===B?(o(t,!0),0===t.strm.avail_out?bt:yt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?It:vt}function g(t,e){for(var i;;){if(0===t.lookahead&&(d(t),0===t.lookahead)){if(e===O)return It;break}if(t.match_length=0,i=S._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(o(t,!1),0===t.strm.avail_out))return It}return t.insert=0,e===B?(o(t,!0),0===t.strm.avail_out?bt:yt):t.last_lit&&(o(t,!1),0===t.strm.avail_out)?It:vt}function I(t,e,i,n,a){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=a}function v(t){t.window_size=2*t.w_size,r(t.head),t.max_lazy_match=A[t.level].max_lazy,t.good_match=A[t.level].good_length,t.nice_match=A[t.level].nice_length,t.max_chain_length=A[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=ot-1,t.match_available=0,t.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new P.Buf16(2*rt),this.dyn_dtree=new P.Buf16(2*(2*nt+1)),this.bl_tree=new P.Buf16(2*(2*at+1)),r(this.dyn_ltree),r(this.dyn_dtree),r(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new P.Buf16(st+1),this.heap=new P.Buf16(2*it+1),r(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new P.Buf16(2*it+1),r(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function y(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=W,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?ft:pt,t.adler=2===e.wrap?0:1,e.last_flush=O,S._tr_init(e),j):n(t,Y)}function w(t){var e=y(t);return e===j&&v(t.state),e}function T(t,e){return t&&t.state?2!==t.state.wrap?Y:(t.state.gzhead=e,j):Y}function x(t,e,i,a,r,s){if(!t)return Y;var o=1;if(e===G&&(e=6),a<0?(o=0,a=-a):a>15&&(o=2,a-=16),r<1||r>$||i!==J||a<8||a>15||e<0||e>9||s<0||s>X)return n(t,Y);8===a&&(a=9);var l=new b;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=a,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+ot-1)/ot),l.window=new P.Buf8(2*l.w_size),l.head=new P.Buf16(l.hash_size),l.prev=new P.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new P.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=i,w(t)}function N(t,e){return x(t,e,J,tt,et,Q)}function F(t,e){var i,o,h,f;if(!t||!t.state||e>R||e<0)return t?n(t,Y):Y;if(o=t.state,!t.output||!t.input&&0!==t.avail_in||o.status===gt&&e!==B)return n(t,0===t.avail_out?Z:Y);if(o.strm=t,i=o.last_flush,o.last_flush=e,o.status===ft)if(2===o.wrap)t.adler=0,l(o,31),l(o,139),l(o,8),o.gzhead?(l(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),l(o,255&o.gzhead.time),l(o,o.gzhead.time>>8&255),l(o,o.gzhead.time>>16&255),l(o,o.gzhead.time>>24&255),l(o,9===o.level?2:o.strategy>=H||o.level<2?4:0),l(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(l(o,255&o.gzhead.extra.length),l(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(t.adler=U(t.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=dt):(l(o,0),l(o,0),l(o,0),l(o,0),l(o,0),l(o,9===o.level?2:o.strategy>=H||o.level<2?4:0),l(o,wt),o.status=pt);else{var d=J+(o.w_bits-8<<4)<<8,c=-1;c=o.strategy>=H||o.level<2?0:o.level<6?1:6===o.level?2:3,d|=c<<6,0!==o.strstart&&(d|=ht),d+=31-d%31,o.status=pt,u(o,d),0!==o.strstart&&(u(o,t.adler>>>16),u(o,65535&t.adler)),t.adler=1}if(o.status===dt)if(o.gzhead.extra){for(h=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>h&&(t.adler=U(t.adler,o.pending_buf,o.pending-h,h)),s(t),h=o.pending,o.pending!==o.pending_buf_size));)l(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>h&&(t.adler=U(t.adler,o.pending_buf,o.pending-h,h)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=ct)}else o.status=ct;if(o.status===ct)if(o.gzhead.name){h=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>h&&(t.adler=U(t.adler,o.pending_buf,o.pending-h,h)),s(t),h=o.pending,o.pending===o.pending_buf_size)){f=1;break}f=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,l(o,f)}while(0!==f);o.gzhead.hcrc&&o.pending>h&&(t.adler=U(t.adler,o.pending_buf,o.pending-h,h)),0===f&&(o.gzindex=0,o.status=_t)}else o.status=_t;if(o.status===_t)if(o.gzhead.comment){h=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>h&&(t.adler=U(t.adler,o.pending_buf,o.pending-h,h)),s(t),h=o.pending,o.pending===o.pending_buf_size)){f=1;break}f=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,l(o,f)}while(0!==f);o.gzhead.hcrc&&o.pending>h&&(t.adler=U(t.adler,o.pending_buf,o.pending-h,h)),0===f&&(o.status=mt)}else o.status=mt;if(o.status===mt&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&s(t),o.pending+2<=o.pending_buf_size&&(l(o,255&t.adler),l(o,t.adler>>8&255),t.adler=0,o.status=pt)):o.status=pt),0!==o.pending){if(s(t),0===t.avail_out)return o.last_flush=-1,j}else if(0===t.avail_in&&a(e)<=a(i)&&e!==B)return n(t,Z);if(o.status===gt&&0!==t.avail_in)return n(t,Z);if(0!==t.avail_in||0!==o.lookahead||e!==O&&o.status!==gt){var _=o.strategy===H?g(o,e):o.strategy===K?p(o,e):A[o.level].func(o,e);if(_!==bt&&_!==yt||(o.status=gt),_===It||_===bt)return 0===t.avail_out&&(o.last_flush=-1),j;if(_===vt&&(e===M?S._tr_align(o):e!==R&&(S._tr_stored_block(o,0,0,!1),e===z&&(r(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),s(t),0===t.avail_out))return o.last_flush=-1,j}return e!==B?j:o.wrap<=0?L:(2===o.wrap?(l(o,255&t.adler),l(o,t.adler>>8&255),l(o,t.adler>>16&255),l(o,t.adler>>24&255),l(o,255&t.total_in),l(o,t.total_in>>8&255),l(o,t.total_in>>16&255),l(o,t.total_in>>24&255)):(u(o,t.adler>>>16),u(o,65535&t.adler)),s(t),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?j:L)}function k(t){var e;return t&&t.state?(e=t.state.status)!==ft&&e!==dt&&e!==ct&&e!==_t&&e!==mt&&e!==pt&&e!==gt?n(t,Y):(t.state=null,e===pt?n(t,q):j):Y}function E(t,e){var i,n,a,s,o,l,u,h,f=e.length;if(!t||!t.state)return Y;if(i=t.state,2===(s=i.wrap)||1===s&&i.status!==ft||i.lookahead)return Y;for(1===s&&(t.adler=D(t.adler,e,f,0)),i.wrap=0,f>=i.w_size&&(0===s&&(r(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new P.Buf8(i.w_size),P.arraySet(h,e,f-i.w_size,i.w_size,0),e=h,f=i.w_size),o=t.avail_in,l=t.next_in,u=t.input,t.avail_in=f,t.next_in=0,t.input=e,d(i);i.lookahead>=ot;){n=i.strstart,a=i.lookahead-(ot-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+ot-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--a);i.strstart=n,i.lookahead=ot-1,d(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=ot-1,i.match_available=0,t.next_in=l,t.input=u,t.avail_in=o,i.wrap=s,j}var A,P=i(0),S=i(23),D=i(9),U=i(10),C=i(3),O=0,M=1,z=3,B=4,R=5,j=0,L=1,Y=-2,q=-3,Z=-5,G=-1,V=1,H=2,K=3,X=4,Q=0,W=2,J=8,$=9,tt=15,et=8,it=286,nt=30,at=19,rt=2*it+1,st=15,ot=3,lt=258,ut=lt+ot+1,ht=32,ft=42,dt=69,ct=73,_t=91,mt=103,pt=113,gt=666,It=1,vt=2,bt=3,yt=4,wt=3;A=[new I(0,0,0,0,c),new I(4,4,8,4,_),new I(4,5,16,8,_),new I(4,6,32,32,_),new I(4,4,16,16,m),new I(8,16,32,32,m),new I(8,16,128,128,m),new I(8,32,128,256,m),new I(32,128,258,1024,m),new I(32,258,258,4096,m)],e.deflateInit=N,e.deflateInit2=x,e.deflateReset=w,e.deflateResetKeep=y,e.deflateSetHeader=T,e.deflate=F,e.deflateEnd=k,e.deflateSetDictionary=E,e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){"use strict";function n(t){for(var e=t.length;--e>=0;)t[e]=0}function a(t,e,i,n,a){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=a,this.has_stree=t&&t.length}function r(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function s(t){return t<256?rt[t]:rt[256+(t>>>7)]}function o(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function l(t,e,i){t.bi_valid>H-i?(t.bi_buf|=e<<t.bi_valid&65535,o(t,t.bi_buf),t.bi_buf=e>>H-t.bi_valid,t.bi_valid+=i-H):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function u(t,e,i){l(t,i[2*e],i[2*e+1])}function h(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function f(t){16===t.bi_valid?(o(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function d(t,e){var i,n,a,r,s,o,l=e.dyn_tree,u=e.max_code,h=e.stat_desc.static_tree,f=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,c=e.stat_desc.extra_base,_=e.stat_desc.max_length,m=0;for(r=0;r<=V;r++)t.bl_count[r]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<G;i++)n=t.heap[i],r=l[2*l[2*n+1]+1]+1,r>_&&(r=_,m++),l[2*n+1]=r,n>u||(t.bl_count[r]++,s=0,n>=c&&(s=d[n-c]),o=l[2*n],t.opt_len+=o*(r+s),f&&(t.static_len+=o*(h[2*n+1]+s)));if(0!==m){do{for(r=_-1;0===t.bl_count[r];)r--;t.bl_count[r]--,t.bl_count[r+1]+=2,t.bl_count[_]--,m-=2}while(m>0);for(r=_;0!==r;r--)for(n=t.bl_count[r];0!==n;)(a=t.heap[--i])>u||(l[2*a+1]!==r&&(t.opt_len+=(r-l[2*a+1])*l[2*a],l[2*a+1]=r),n--)}}function c(t,e,i){var n,a,r=new Array(V+1),s=0;for(n=1;n<=V;n++)r[n]=s=s+i[n-1]<<1;for(a=0;a<=e;a++){var o=t[2*a+1];0!==o&&(t[2*a]=h(r[o]++,o))}}function _(){var t,e,i,n,r,s=new Array(V+1);for(i=0,n=0;n<j-1;n++)for(ot[n]=i,t=0;t<1<<$[n];t++)st[i++]=n;for(st[i-1]=n,r=0,n=0;n<16;n++)for(lt[n]=r,t=0;t<1<<tt[n];t++)rt[r++]=n;for(r>>=7;n<q;n++)for(lt[n]=r<<7,t=0;t<1<<tt[n]-7;t++)rt[256+r++]=n;for(e=0;e<=V;e++)s[e]=0;for(t=0;t<=143;)nt[2*t+1]=8,t++,s[8]++;for(;t<=255;)nt[2*t+1]=9,t++,s[9]++;for(;t<=279;)nt[2*t+1]=7,t++,s[7]++;for(;t<=287;)nt[2*t+1]=8,t++,s[8]++;for(c(nt,Y+1,s),t=0;t<q;t++)at[2*t+1]=5,at[2*t]=h(t,5);ut=new a(nt,$,L+1,Y,V),ht=new a(at,tt,0,q,V),ft=new a(new Array(0),et,0,Z,K)}function m(t){var e;for(e=0;e<Y;e++)t.dyn_ltree[2*e]=0;for(e=0;e<q;e++)t.dyn_dtree[2*e]=0;for(e=0;e<Z;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*X]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function p(t){t.bi_valid>8?o(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function g(t,e,i,n){p(t),n&&(o(t,i),o(t,~i)),D.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}function I(t,e,i,n){var a=2*e,r=2*i;return t[a]<t[r]||t[a]===t[r]&&n[e]<=n[i]}function v(t,e,i){for(var n=t.heap[i],a=i<<1;a<=t.heap_len&&(a<t.heap_len&&I(e,t.heap[a+1],t.heap[a],t.depth)&&a++,!I(e,n,t.heap[a],t.depth));)t.heap[i]=t.heap[a],i=a,a<<=1;t.heap[i]=n}function b(t,e,i){var n,a,r,o,h=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*h]<<8|t.pending_buf[t.d_buf+2*h+1],a=t.pending_buf[t.l_buf+h],h++,0===n?u(t,a,e):(r=st[a],u(t,r+L+1,e),o=$[r],0!==o&&(a-=ot[r],l(t,a,o)),n--,r=s(n),u(t,r,i),0!==(o=tt[r])&&(n-=lt[r],l(t,n,o)))}while(h<t.last_lit);u(t,X,e)}function y(t,e){var i,n,a,r=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=G,i=0;i<l;i++)0!==r[2*i]?(t.heap[++t.heap_len]=u=i,t.depth[i]=0):r[2*i+1]=0;for(;t.heap_len<2;)a=t.heap[++t.heap_len]=u<2?++u:0,r[2*a]=1,t.depth[a]=0,t.opt_len--,o&&(t.static_len-=s[2*a+1]);for(e.max_code=u,i=t.heap_len>>1;i>=1;i--)v(t,r,i);a=l;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],v(t,r,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,r[2*a]=r[2*i]+r[2*n],t.depth[a]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,r[2*i+1]=r[2*n+1]=a,t.heap[1]=a++,v(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],d(t,e),c(r,u,t.bl_count)}function w(t,e,i){var n,a,r=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)a=s,s=e[2*(n+1)+1],++o<l&&a===s||(o<u?t.bl_tree[2*a]+=o:0!==a?(a!==r&&t.bl_tree[2*a]++,t.bl_tree[2*Q]++):o<=10?t.bl_tree[2*W]++:t.bl_tree[2*J]++,o=0,r=a,0===s?(l=138,u=3):a===s?(l=6,u=3):(l=7,u=4))}function T(t,e,i){var n,a,r=-1,s=e[1],o=0,h=7,f=4;for(0===s&&(h=138,f=3),n=0;n<=i;n++)if(a=s,s=e[2*(n+1)+1],!(++o<h&&a===s)){if(o<f)do{u(t,a,t.bl_tree)}while(0!=--o);else 0!==a?(a!==r&&(u(t,a,t.bl_tree),o--),u(t,Q,t.bl_tree),l(t,o-3,2)):o<=10?(u(t,W,t.bl_tree),l(t,o-3,3)):(u(t,J,t.bl_tree),l(t,o-11,7));o=0,r=a,0===s?(h=138,f=3):a===s?(h=6,f=3):(h=7,f=4)}}function x(t){var e;for(w(t,t.dyn_ltree,t.l_desc.max_code),w(t,t.dyn_dtree,t.d_desc.max_code),y(t,t.bl_desc),e=Z-1;e>=3&&0===t.bl_tree[2*it[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function N(t,e,i,n){var a;for(l(t,e-257,5),l(t,i-1,5),l(t,n-4,4),a=0;a<n;a++)l(t,t.bl_tree[2*it[a]+1],3);T(t,t.dyn_ltree,e-1),T(t,t.dyn_dtree,i-1)}function F(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return C;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return O;for(e=32;e<L;e++)if(0!==t.dyn_ltree[2*e])return O;return C}function k(t){dt||(_(),dt=!0),t.l_desc=new r(t.dyn_ltree,ut),t.d_desc=new r(t.dyn_dtree,ht),t.bl_desc=new r(t.bl_tree,ft),t.bi_buf=0,t.bi_valid=0,m(t)}function E(t,e,i,n){l(t,(z<<1)+(n?1:0),3),g(t,e,i,!0)}function A(t){l(t,B<<1,3),u(t,X,nt),f(t)}function P(t,e,i,n){var a,r,s=0;t.level>0?(t.strm.data_type===M&&(t.strm.data_type=F(t)),y(t,t.l_desc),y(t,t.d_desc),s=x(t),a=t.opt_len+3+7>>>3,(r=t.static_len+3+7>>>3)<=a&&(a=r)):a=r=i+5,i+4<=a&&-1!==e?E(t,e,i,n):t.strategy===U||r===a?(l(t,(B<<1)+(n?1:0),3),b(t,nt,at)):(l(t,(R<<1)+(n?1:0),3),N(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),b(t,t.dyn_ltree,t.dyn_dtree)),m(t),n&&p(t)}function S(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(st[i]+L+1)]++,t.dyn_dtree[2*s(e)]++),t.last_lit===t.lit_bufsize-1}var D=i(0),U=4,C=0,O=1,M=2,z=0,B=1,R=2,j=29,L=256,Y=L+1+j,q=30,Z=19,G=2*Y+1,V=15,H=16,K=7,X=256,Q=16,W=17,J=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],et=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],it=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],nt=new Array(2*(Y+2));n(nt);var at=new Array(2*q);n(at);var rt=new Array(512);n(rt);var st=new Array(256);n(st);var ot=new Array(j);n(ot);var lt=new Array(q);n(lt);var ut,ht,ft,dt=!1;e._tr_init=k,e._tr_stored_block=E,e._tr_flush_block=P,e._tr_tally=S,e._tr_align=A},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,e.windowBits);if(i!==u.Z_OK)throw new Error(h[i]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function a(t,e){var i=new n(e);if(i.push(t,!0),i.err)throw i.msg||h[i.err];return i.result}function r(t,e){return e=e||{},e.raw=!0,a(t,e)}var s=i(25),o=i(0),l=i(11),u=i(13),h=i(3),f=i(12),d=i(28),c=Object.prototype.toString;n.prototype.push=function(t,e){var i,n,a,r,h,f,d=this.strm,_=this.options.chunkSize,m=this.options.dictionary,p=!1;if(this.ended)return!1;n=e===~~e?e:!0===e?u.Z_FINISH:u.Z_NO_FLUSH,"string"==typeof t?d.input=l.binstring2buf(t):"[object ArrayBuffer]"===c.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new o.Buf8(_),d.next_out=0,d.avail_out=_),i=s.inflate(d,u.Z_NO_FLUSH),i===u.Z_NEED_DICT&&m&&(f="string"==typeof m?l.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,i=s.inflateSetDictionary(this.strm,f)),i===u.Z_BUF_ERROR&&!0===p&&(i=u.Z_OK,p=!1),i!==u.Z_STREAM_END&&i!==u.Z_OK)return this.onEnd(i),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&i!==u.Z_STREAM_END&&(0!==d.avail_in||n!==u.Z_FINISH&&n!==u.Z_SYNC_FLUSH)||("string"===this.options.to?(a=l.utf8border(d.output,d.next_out),r=d.next_out-a,h=l.buf2string(d.output,a),d.next_out=r,d.avail_out=_-r,r&&o.arraySet(d.output,d.output,a,r,0),this.onData(h)):this.onData(o.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(p=!0)}while((d.avail_in>0||0===d.avail_out)&&i!==u.Z_STREAM_END);return i===u.Z_STREAM_END&&(n=u.Z_FINISH),n===u.Z_FINISH?(i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===u.Z_OK):n!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),d.avail_out=0,!0)},n.prototype.onData=function(t){this.chunks.push(t)},n.prototype.onEnd=function(t){t===u.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=n,e.inflate=a,e.inflateRaw=r,e.ungzip=a},function(t,e,i){"use strict";function n(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function a(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new I.Buf16(320),this.work=new I.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function r(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=z,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new I.Buf32(mt),e.distcode=e.distdyn=new I.Buf32(pt),e.sane=1,e.back=-1,A):D}function s(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,r(t)):D}function o(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?D:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,s(t))):D}function l(t,e){var i,n;return t?(n=new a,t.state=n,n.window=null,i=o(t,e),i!==A&&(t.state=null),i):D}function u(t){return l(t,gt)}function h(t){if(It){var e;for(p=new I.Buf32(512),g=new I.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(w(x,t.lens,0,288,p,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;w(N,t.lens,0,32,g,0,t.work,{bits:5}),It=!1}t.lencode=p,t.lenbits=9,t.distcode=g,t.distbits=5}function f(t,e,i,n){var a,r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new I.Buf8(r.wsize)),n>=r.wsize?(I.arraySet(r.window,e,i-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(a=r.wsize-r.wnext,a>n&&(a=n),I.arraySet(r.window,e,i-n,a,r.wnext),n-=a,n?(I.arraySet(r.window,e,i-n,n,0),r.wnext=n,r.whave=r.wsize):(r.wnext+=a,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=a))),0}function d(t,e){var i,a,r,s,o,l,u,d,c,_,m,p,g,mt,pt,gt,It,vt,bt,yt,wt,Tt,xt,Nt,Ft=0,kt=new I.Buf8(4),Et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return D;i=t.state,i.mode===K&&(i.mode=X),o=t.next_out,r=t.output,u=t.avail_out,s=t.next_in,a=t.input,l=t.avail_in,d=i.hold,c=i.bits,_=l,m=u,Tt=A;t:for(;;)switch(i.mode){case z:if(0===i.wrap){i.mode=X;break}for(;c<16;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(2&i.wrap&&35615===d){i.check=0,kt[0]=255&d,kt[1]=d>>>8&255,i.check=b(i.check,kt,2,0),d=0,c=0,i.mode=B;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){t.msg="incorrect header check",i.mode=dt;break}if((15&d)!==M){t.msg="unknown compression method",i.mode=dt;break}if(d>>>=4,c-=4,wt=8+(15&d),0===i.wbits)i.wbits=wt;else if(wt>i.wbits){t.msg="invalid window size",i.mode=dt;break}i.dmax=1<<wt,t.adler=i.check=1,i.mode=512&d?V:K,d=0,c=0;break;case B:for(;c<16;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(i.flags=d,(255&i.flags)!==M){t.msg="unknown compression method",i.mode=dt;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=dt;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&(kt[0]=255&d,kt[1]=d>>>8&255,i.check=b(i.check,kt,2,0)),d=0,c=0,i.mode=R;case R:for(;c<32;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}i.head&&(i.head.time=d),512&i.flags&&(kt[0]=255&d,kt[1]=d>>>8&255,kt[2]=d>>>16&255,kt[3]=d>>>24&255,i.check=b(i.check,kt,4,0)),d=0,c=0,i.mode=j;case j:for(;c<16;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&(kt[0]=255&d,kt[1]=d>>>8&255,i.check=b(i.check,kt,2,0)),d=0,c=0,i.mode=L;case L:if(1024&i.flags){for(;c<16;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&(kt[0]=255&d,kt[1]=d>>>8&255,i.check=b(i.check,kt,2,0)),d=0,c=0}else i.head&&(i.head.extra=null);i.mode=Y;case Y:if(1024&i.flags&&(p=i.length,p>l&&(p=l),p&&(i.head&&(wt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),I.arraySet(i.head.extra,a,s,p,wt)),512&i.flags&&(i.check=b(i.check,a,p,s)),l-=p,s+=p,i.length-=p),i.length))break t;i.length=0,i.mode=q;case q:if(2048&i.flags){if(0===l)break t;p=0;do{wt=a[s+p++],i.head&&wt&&i.length<65536&&(i.head.name+=String.fromCharCode(wt))}while(wt&&p<l);if(512&i.flags&&(i.check=b(i.check,a,p,s)),l-=p,s+=p,wt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=Z;case Z:if(4096&i.flags){if(0===l)break t;p=0;do{wt=a[s+p++],i.head&&wt&&i.length<65536&&(i.head.comment+=String.fromCharCode(wt))}while(wt&&p<l);if(512&i.flags&&(i.check=b(i.check,a,p,s)),l-=p,s+=p,wt)break t}else i.head&&(i.head.comment=null);i.mode=G;case G:if(512&i.flags){for(;c<16;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(d!==(65535&i.check)){t.msg="header crc mismatch",i.mode=dt;break}d=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=K;break;case V:for(;c<32;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}t.adler=i.check=n(d),d=0,c=0,i.mode=H;case H:if(0===i.havedict)return t.next_out=o,t.avail_out=u,t.next_in=s,t.avail_in=l,i.hold=d,i.bits=c,S;t.adler=i.check=1,i.mode=K;case K:if(e===k||e===E)break t;case X:if(i.last){d>>>=7&c,c-=7&c,i.mode=ut;break}for(;c<3;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}switch(i.last=1&d,d>>>=1,c-=1,3&d){case 0:i.mode=Q;break;case 1:if(h(i),i.mode=it,e===E){d>>>=2,c-=2;break t}break;case 2:i.mode=$;break;case 3:t.msg="invalid block type",i.mode=dt}d>>>=2,c-=2;break;case Q:for(d>>>=7&c,c-=7&c;c<32;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){t.msg="invalid stored block lengths",i.mode=dt;break}if(i.length=65535&d,d=0,c=0,i.mode=W,e===E)break t;case W:i.mode=J;case J:if(p=i.length){if(p>l&&(p=l),p>u&&(p=u),0===p)break t;I.arraySet(r,a,s,p,o),l-=p,s+=p,u-=p,o+=p,i.length-=p;break}i.mode=K;break;case $:for(;c<14;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(i.nlen=257+(31&d),d>>>=5,c-=5,i.ndist=1+(31&d),d>>>=5,c-=5,i.ncode=4+(15&d),d>>>=4,c-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=dt;break}i.have=0,i.mode=tt;case tt:for(;i.have<i.ncode;){for(;c<3;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}i.lens[Et[i.have++]]=7&d,d>>>=3,c-=3}for(;i.have<19;)i.lens[Et[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,xt={bits:i.lenbits},Tt=w(T,i.lens,0,19,i.lencode,0,i.work,xt),i.lenbits=xt.bits,Tt){t.msg="invalid code lengths set",i.mode=dt;break}i.have=0,i.mode=et;case et:for(;i.have<i.nlen+i.ndist;){for(;Ft=i.lencode[d&(1<<i.lenbits)-1],pt=Ft>>>24,gt=Ft>>>16&255,It=65535&Ft,!(pt<=c);){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(It<16)d>>>=pt,c-=pt,i.lens[i.have++]=It;else{if(16===It){for(Nt=pt+2;c<Nt;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(d>>>=pt,c-=pt,0===i.have){t.msg="invalid bit length repeat",i.mode=dt;break}wt=i.lens[i.have-1],p=3+(3&d),d>>>=2,c-=2}else if(17===It){for(Nt=pt+3;c<Nt;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}d>>>=pt,c-=pt,wt=0,p=3+(7&d),d>>>=3,c-=3}else{for(Nt=pt+7;c<Nt;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}d>>>=pt,c-=pt,wt=0,p=11+(127&d),d>>>=7,c-=7}if(i.have+p>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=dt;break}for(;p--;)i.lens[i.have++]=wt}}if(i.mode===dt)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=dt;break}if(i.lenbits=9,xt={bits:i.lenbits},Tt=w(x,i.lens,0,i.nlen,i.lencode,0,i.work,xt),i.lenbits=xt.bits,Tt){t.msg="invalid literal/lengths set",i.mode=dt;break}if(i.distbits=6,i.distcode=i.distdyn,xt={bits:i.distbits},Tt=w(N,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,xt),i.distbits=xt.bits,Tt){t.msg="invalid distances set",i.mode=dt;break}if(i.mode=it,e===E)break t;case it:i.mode=nt;case nt:if(l>=6&&u>=258){t.next_out=o,t.avail_out=u,t.next_in=s,t.avail_in=l,i.hold=d,i.bits=c,y(t,m),o=t.next_out,r=t.output,u=t.avail_out,s=t.next_in,a=t.input,l=t.avail_in,d=i.hold,c=i.bits,i.mode===K&&(i.back=-1);break}for(i.back=0;Ft=i.lencode[d&(1<<i.lenbits)-1],pt=Ft>>>24,gt=Ft>>>16&255,It=65535&Ft,!(pt<=c);){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(gt&&0==(240&gt)){for(vt=pt,bt=gt,yt=It;Ft=i.lencode[yt+((d&(1<<vt+bt)-1)>>vt)],pt=Ft>>>24,gt=Ft>>>16&255,It=65535&Ft,!(vt+pt<=c);){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}d>>>=vt,c-=vt,i.back+=vt}if(d>>>=pt,c-=pt,i.back+=pt,i.length=It,0===gt){i.mode=lt;break}if(32&gt){i.back=-1,i.mode=K;break}if(64&gt){t.msg="invalid literal/length code",i.mode=dt;break}i.extra=15&gt,i.mode=at;case at:if(i.extra){for(Nt=i.extra;c<Nt;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=rt;case rt:for(;Ft=i.distcode[d&(1<<i.distbits)-1],pt=Ft>>>24,gt=Ft>>>16&255,It=65535&Ft,!(pt<=c);){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(0==(240&gt)){for(vt=pt,bt=gt,yt=It;Ft=i.distcode[yt+((d&(1<<vt+bt)-1)>>vt)],pt=Ft>>>24,gt=Ft>>>16&255,It=65535&Ft,!(vt+pt<=c);){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}d>>>=vt,c-=vt,i.back+=vt}if(d>>>=pt,c-=pt,i.back+=pt,64&gt){t.msg="invalid distance code",i.mode=dt;break}i.offset=It,i.extra=15&gt,i.mode=st;case st:if(i.extra){for(Nt=i.extra;c<Nt;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=dt;break}i.mode=ot;case ot:if(0===u)break t;if(p=m-u,i.offset>p){if((p=i.offset-p)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=dt;break}p>i.wnext?(p-=i.wnext,g=i.wsize-p):g=i.wnext-p,p>i.length&&(p=i.length),mt=i.window}else mt=r,g=o-i.offset,p=i.length;p>u&&(p=u),u-=p,i.length-=p;do{r[o++]=mt[g++]}while(--p);0===i.length&&(i.mode=nt);break;case lt:if(0===u)break t;r[o++]=i.length,u--,i.mode=nt;break;case ut:if(i.wrap){for(;c<32;){if(0===l)break t;l--,d|=a[s++]<<c,c+=8}if(m-=u,t.total_out+=m,i.total+=m,m&&(t.adler=i.check=i.flags?b(i.check,r,m,o-m):v(i.check,r,m,o-m)),m=u,(i.flags?d:n(d))!==i.check){t.msg="incorrect data check",i.mode=dt;break}d=0,c=0}i.mode=ht;case ht:if(i.wrap&&i.flags){for(;c<32;){if(0===l)break t;l--,d+=a[s++]<<c,c+=8}if(d!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=dt;break}d=0,c=0}i.mode=ft;case ft:Tt=P;break t;case dt:Tt=U;break t;case ct:return C;case _t:default:return D}return t.next_out=o,t.avail_out=u,t.next_in=s,t.avail_in=l,i.hold=d,i.bits=c,(i.wsize||m!==t.avail_out&&i.mode<dt&&(i.mode<ut||e!==F))&&f(t,t.output,t.next_out,m-t.avail_out)?(i.mode=ct,C):(_-=t.avail_in,m-=t.avail_out,t.total_in+=_,t.total_out+=m,i.total+=m,i.wrap&&m&&(t.adler=i.check=i.flags?b(i.check,r,m,t.next_out-m):v(i.check,r,m,t.next_out-m)),t.data_type=i.bits+(i.last?64:0)+(i.mode===K?128:0)+(i.mode===it||i.mode===W?256:0),(0===_&&0===m||e===F)&&Tt===A&&(Tt=O),Tt)}function c(t){if(!t||!t.state)return D;var e=t.state;return e.window&&(e.window=null),t.state=null,A}function _(t,e){var i;return t&&t.state?(i=t.state,0==(2&i.wrap)?D:(i.head=e,e.done=!1,A)):D}function m(t,e){var i,n,a=e.length;return t&&t.state?(i=t.state,0!==i.wrap&&i.mode!==H?D:i.mode===H&&(n=1,(n=v(n,e,a,0))!==i.check)?U:f(t,e,a,a)?(i.mode=ct,C):(i.havedict=1,A)):D}var p,g,I=i(0),v=i(9),b=i(10),y=i(26),w=i(27),T=0,x=1,N=2,F=4,k=5,E=6,A=0,P=1,S=2,D=-2,U=-3,C=-4,O=-5,M=8,z=1,B=2,R=3,j=4,L=5,Y=6,q=7,Z=8,G=9,V=10,H=11,K=12,X=13,Q=14,W=15,J=16,$=17,tt=18,et=19,it=20,nt=21,at=22,rt=23,st=24,ot=25,lt=26,ut=27,ht=28,ft=29,dt=30,ct=31,_t=32,mt=852,pt=592,gt=15,It=!0;e.inflateReset=s,e.inflateReset2=o,e.inflateResetKeep=r,e.inflateInit=u,e.inflateInit2=l,e.inflate=d,e.inflateEnd=c,e.inflateGetHeader=_,e.inflateSetDictionary=m,e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,a,r,s,o,l,u,h,f,d,c,_,m,p,g,I,v,b,y,w,T,x,N,F;i=t.state,n=t.next_in,N=t.input,a=n+(t.avail_in-5),r=t.next_out,F=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),l=i.dmax,u=i.wsize,h=i.whave,f=i.wnext,d=i.window,c=i.hold,_=i.bits,m=i.lencode,p=i.distcode,g=(1<<i.lenbits)-1,I=(1<<i.distbits)-1;t:do{_<15&&(c+=N[n++]<<_,_+=8,c+=N[n++]<<_,_+=8),v=m[c&g];e:for(;;){if(b=v>>>24,c>>>=b,_-=b,0===(b=v>>>16&255))F[r++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=m[(65535&v)+(c&(1<<b)-1)];continue e}if(32&b){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}y=65535&v,b&=15,b&&(_<b&&(c+=N[n++]<<_,_+=8),y+=c&(1<<b)-1,c>>>=b,_-=b),_<15&&(c+=N[n++]<<_,_+=8,c+=N[n++]<<_,_+=8),v=p[c&I];i:for(;;){if(b=v>>>24,c>>>=b,_-=b,!(16&(b=v>>>16&255))){if(0==(64&b)){v=p[(65535&v)+(c&(1<<b)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(w=65535&v,b&=15,_<b&&(c+=N[n++]<<_,(_+=8)<b&&(c+=N[n++]<<_,_+=8)),(w+=c&(1<<b)-1)>l){t.msg="invalid distance too far back",i.mode=30;break t}if(c>>>=b,_-=b,b=r-s,w>b){if((b=w-b)>h&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(T=0,x=d,0===f){if(T+=u-b,b<y){y-=b;do{F[r++]=d[T++]}while(--b);T=r-w,x=F}}else if(f<b){if(T+=u+f-b,(b-=f)<y){y-=b;do{F[r++]=d[T++]}while(--b);if(T=0,f<y){b=f,y-=b;do{F[r++]=d[T++]}while(--b);T=r-w,x=F}}}else if(T+=f-b,b<y){y-=b;do{F[r++]=d[T++]}while(--b);T=r-w,x=F}for(;y>2;)F[r++]=x[T++],F[r++]=x[T++],F[r++]=x[T++],y-=3;y&&(F[r++]=x[T++],y>1&&(F[r++]=x[T++]))}else{T=r-w;do{F[r++]=F[T++],F[r++]=F[T++],F[r++]=F[T++],y-=3}while(y>2);y&&(F[r++]=F[T++],y>1&&(F[r++]=F[T++]))}break}}break}}while(n<a&&r<o);y=_>>3,n-=y,_-=y<<3,c&=(1<<_)-1,t.next_in=n,t.next_out=r,t.avail_in=n<a?a-n+5:5-(n-a),t.avail_out=r<o?o-r+257:257-(r-o),i.hold=c,i.bits=_}},function(t,e,i){"use strict";var n=i(0),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,l,u,h,f,d){var c,_,m,p,g,I,v,b,y,w=d.bits,T=0,x=0,N=0,F=0,k=0,E=0,A=0,P=0,S=0,D=0,U=null,C=0,O=new n.Buf16(16),M=new n.Buf16(16),z=null,B=0;for(T=0;T<=15;T++)O[T]=0;for(x=0;x<l;x++)O[e[i+x]]++;for(k=w,F=15;F>=1&&0===O[F];F--);if(k>F&&(k=F),0===F)return u[h++]=20971520,u[h++]=20971520,d.bits=1,0;for(N=1;N<F&&0===O[N];N++);for(k<N&&(k=N),P=1,T=1;T<=15;T++)if(P<<=1,(P-=O[T])<0)return-1;if(P>0&&(0===t||1!==F))return-1;for(M[1]=0,T=1;T<15;T++)M[T+1]=M[T]+O[T];for(x=0;x<l;x++)0!==e[i+x]&&(f[M[e[i+x]]++]=x);if(0===t?(U=z=f,I=19):1===t?(U=a,C-=257,z=r,B-=257,I=256):(U=s,z=o,I=-1),D=0,x=0,T=N,g=h,E=k,A=0,m=-1,S=1<<k,p=S-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){v=T-A,f[x]<I?(b=0,y=f[x]):f[x]>I?(b=z[B+f[x]],y=U[C+f[x]]):(b=96,y=0),c=1<<T-A,_=1<<E,N=_;do{_-=c,u[g+(D>>A)+_]=v<<24|b<<16|y|0}while(0!==_);for(c=1<<T-1;D&c;)c>>=1;if(0!==c?(D&=c-1,D+=c):D=0,x++,0==--O[T]){if(T===F)break;T=e[i+f[x]]}if(T>k&&(D&p)!==m){for(0===A&&(A=k),g+=N,E=T-A,P=1<<E;E+A<F&&!((P-=O[E+A])<=0);)E++,P<<=1;if(S+=1<<E,1===t&&S>852||2===t&&S>592)return 1;m=D&p,u[m]=k<<24|E<<16|g-h|0}}return 0!==D&&(u[g+D]=T-A<<24|64<<16|0),d.bits=k,0}},function(t,e,i){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},function(t,e,i){"use strict";function n(t){r.default.register(t)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(6),r=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e,i,n){var a=n*t+e,r=i*t+e;return{windowCenter:(a+r)/2,windowWidth:a-r}}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(31),u=n(l),h=i(39),f=n(h),d=i(40),c=n(d),_=i(41),m=n(_),p=i(42),g=i(44),I=n(g),v=i(4),b=n(v),y=i(45),w=n(y),T=i(5),x=n(T),N=Symbol("decompress"),F=Symbol("readMetaData"),k=Symbol("readImageData"),E=Symbol("determineImageDependentMetaData"),A=Symbol("transformImageData"),P=Symbol("createVolume"),S=Symbol("cacheVolume"),D=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.volumeCache=new f.default,this.volumePromises={},this.wholeFileFetcher=new c.default({headers:i}),this.headerOnlyFetcher=new c.default({isFirstBytesOnly:!0,headers:i,beforeSend:function(t){return t.setRequestHeader("Range","bytes=0-10240")},onHeadersReceived:function(t,i,n){if(200===t.status){var a=b.default.fromURL(n.imageId),r=e.headerOnlyFetcher.getFetchPromiseFromCache(a);e.wholeFileFetcher.addFetchPromiseToCache(r.promise,a)}}})}return o(t,[{key:"acquire",value:function(t){var e=this,i=this.volumePromises[t.filePath];if(i&&i.wholeFilePromise)return i.wholeFilePromise;var n=new Promise(function(i,n){var a=e.volumeCache.get(t);if(a&&a.hasImageData)return void i(a);e.wholeFileFetcher.fetch(t).then(function(i){return e[N](i,t)}).then(function(t){return e[F](t)}).then(function(t){return e[k](t)}).then(function(t){return e[A](t)}).then(function(t){return e[E](t)}).then(function(i){return e[P](i,t)}).then(function(i){return e[S](i,t)}).then(function(t){return i(t)}).catch(n)});return this.volumePromises[t.filePath]=this.volumePromises[t.filePath]||{},this.volumePromises[t.filePath].wholeFilePromise=n,n}},{key:"acquireHeaderOnly",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.volumePromises[t.filePath];if(n)return n.headerOnlyPromise||n.wholeFilePromise;var a=new Promise(function(n,a){var r=e.volumeCache.get(t);if(r)return void n(r);(i?e.headerOnlyFetcher:e.wholeFileFetcher).fetch(t).then(function(i){return e[N](i,t)}).then(function(t){return e[F](t)}).then(function(i){return e[P](i,t)}).then(function(i){return e[S](i,t)}).then(function(t){return n(t)}).catch(a)});return this.volumePromises[t.filePath]=this.volumePromises[t.filePath]||{},this.volumePromises[t.filePath].headerOnlyPromise=a,a}},{key:N,value:function(t,e){return(0,m.default)(t,e)}},{key:F,value:function(t){return{decompressedFileData:t,metaData:(0,p.parseNiftiHeader)(t)}}},{key:k,value:function(t){var e=t.decompressedFileData,i=t.metaData,n=(0,p.parseNiftiFile)(e,i),r=n.imageData,s=n.metaData;Object.assign(i,s);var o=i.voxelLength,l=i.timeSlices,u=[1,o[0],o[0]*o[1],o[0]*o[1]*o[2]],h=(0,x.default)(r,[].concat(a(o),[l]),u),f=(0,w.default)(h);return i.minPixelValue=f.min,i.maxPixelValue=f.max,{metaData:i,imageDataNDarray:h}}},{key:A,value:function(t){var e=t.metaData,i=t.imageDataNDarray;if(e.dataType.isDataInFloat){var n=(0,I.default)(i,e);i=n.convertedImageDataView,Object.assign(e,n.metaData,{floatImageDataNDarray:n.floatImageDataView})}return{metaData:e,imageDataNDarray:i}}},{key:E,value:function(t){var e=t.metaData,i=t.imageDataNDarray;return e.isWindowInfoAbsent?Object.assign(e,s(e.slope,e.intercept,e.minPixelValue,e.maxPixelValue)):Object.assign(e,s(1,0,e.windowMinimumValue,e.windowMaximumValue)),{metaData:e,imageDataNDarray:i}}},{key:P,value:function(t,e){var i=t.metaData,n=t.imageDataNDarray;return new u.default(e,i,n,i.floatImageDataNDarray)}},{key:S,value:function(t,e){return this.volumeCache.add(e,t),t}}],[{key:"getInstance",value:function(e){return t.instance||(t.instance=new t(e)),t.instance}}]),t}();e.default=D},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){a=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(32),u=n(l),h=i(5),f=n(h),d=Symbol("convertToNeurologicalView"),c=Symbol("ensureVoxelStorageInXYZ"),_=Symbol("changeVoxelStorageOrder"),m=Symbol("convertRAStoLPS"),p=function(){function t(e,i,n,a){r(this,t),this.imageIdObject=e,this.metaData=i,this.imageDataNDarray=n,this.floatImageDataNDarray=a,this[c](),this[d](),this[m]()}return o(t,[{key:c,value:function(){var t=this.metaData.orientationString,e=t.slice(0,3);switch(e){case"XYZ":break;case"XZY":this[_]([0,2,1]);break;case"YZX":this[_]([2,0,1]);break;default:console.info("The NIfTI file "+this.imageIdObject.filePath+" has its\n        voxel values stored in "+e+" order in the file,\n        which is a rare orientation unsupported by the viewer. Hence,\n        the viewer is not doing auto flipping to match the neurological view.")}}},{key:_,value:function(t){var e,i=s(t,3),n=i[0],r=i[1],o=i[2];this.hasImageData&&(this.imageDataNDarray=this.imageDataNDarray.transpose(n,r,o,3),this.floatImageDataNDarray&&(this.floatImageDataNDarray=this.floatImageDataNDarray.transpose(n,r,o,3))),this.metaData.voxelLength=[this.metaData.voxelLength[n],this.metaData.voxelLength[r],this.metaData.voxelLength[o]];var l=this.metaData.orientationMatrix,u=JSON.parse(JSON.stringify(l)),h=(0,f.default)((e=[]).concat.apply(e,a(u)),[4,4]).transpose(1,0),d=[h.pick(0,null),h.pick(1,null),h.pick(2,null),h.pick(3,null)];l[0]=[d[n].get(0),d[n].get(1),d[n].get(2),d[3].get(n)],l[1]=[d[r].get(0),d[r].get(1),d[r].get(2),-d[3].get(r)],l[2]=[d[o].get(0),d[o].get(1),d[o].get(2),-d[3].get(o)];var c=[this.metaData.pixelSpacing[n],this.metaData.pixelSpacing[r],this.metaData.pixelSpacing[o]];this.metaData.pixelSpacing=c.slice(0);var _=this.metaData.orientationString,m=_.slice(3,6);m=[m[n],m[r],m[o]].join(""),this.metaData.orientationString="XYZ"+m}},{key:d,value:function(){var t=this.metaData.orientationMatrix,e=this.metaData.orientationString.slice(3,6),i=[1,1,1];if("XYZ"===this.metaData.orientationString.slice(0,3)&&("-"===e[0]&&(t[0][0]*=-1,t[0][1]*=-1,t[0][2]*=-1,t[0][3]*=-1,i[0]=-1),"+"===e[1]&&(t[1][0]*=-1,t[1][1]*=-1,t[1][2]*=-1,t[1][3]*=-1,i[1]=-1),"+"===e[2]&&(t[2][0]*=-1,t[2][1]*=-1,t[2][2]*=-1,t[2][3]*=-1,i[2]=-1)),this.hasImageData){var n;if(this.imageDataNDarray=(n=this.imageDataNDarray).step.apply(n,i.concat([1])),this.floatImageDataNDarray){var a;this.floatImageDataNDarray=(a=this.floatImageDataNDarray).step.apply(a,i.concat([1]))}}}},{key:m,value:function(){var t=this.metaData.orientationMatrix;t[0][0]*=-1,t[0][1]*=-1,t[0][2]*=-1,t[0][3]*=-1,t[1][0]*=-1,t[1][1]*=-1,t[1][2]*=-1,t[1][3]*=-1}},{key:"slice",value:function(t){return new u.default(this,t)}},{key:"hasImageData",get:function(){return this.imageDataNDarray&&this.imageDataNDarray.data&&this.imageDataNDarray.data.byteLength>0}},{key:"sizeInBytes",get:function(){return(this.imageDataNDarray?this.imageDataNDarray.data.byteLength:0)+(this.floatImageDataView?this.floatImageDataView.data.byteLength:0)}}]),t}();e.default=p},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function a(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(1),l=i(33),u=n(l),h=i(34),f=n(h),d=i(35),c=n(d),_=i(36),m=n(_),p=Symbol("determineMetaData"),g=Symbol("determinePixelData"),I=Symbol("getDimensionsIndices"),v=Symbol("getPatientOrientation"),b=Symbol("getPatientPosition"),y=function(){function t(e,i){r(this,t),this.volume=e,this.imageIdObject=i,this.dimension=i.slice.dimension,this.index=i.slice.index,this.timePoint=i.timePoint,this.metaData={},this[p](),this.volume.hasImageData&&this[g]()}return s(t,[{key:p,value:function(){var t=this.volume.metaData,e=this[I](this.dimension),i=e.rowsIndex,n=e.columnsIndex,r=e.framesIndex,s=t.voxelLength,o=s[i],l=s[n],u=s[r],h=t.pixelSpacing[i],f=t.pixelSpacing[n],d=t.pixelSpacing[r],c=this[v](t.orientationMatrix,n,i),_=c.rowCosines,m=c.columnCosines,p=this[b](t.orientationMatrix,r);Object.assign(this.metaData,{columns:l,rows:o,numberOfFrames:u,columnsIndex:n,rowsIndex:i,framesIndex:r,columnPixelSpacing:f,rowPixelSpacing:h,slicePixelSpacing:d,columnCosines:m,rowCosines:_,imagePositionPatient:p,imageOrientationPatient:[].concat(a(_),a(m)),frameOfReferenceUID:this.imageIdObject.filePath})}},{key:g,value:function(){var t;this.volume.imageDataNDarray.set(0,0,0,255);var e=(0,f.default)([this.index,null,null],this.metaData.framesIndex),i=this.volume.metaData.dataType.TypedArrayConstructor,n=(t=this.volume.imageDataNDarray).pick.apply(t,a(e).concat([this.timePoint]));if(this.pixelData=(0,u.default)(n,i),this.volume.metaData.dataType.isDataInFloat){var r,s=(r=this.volume.imageDataNDarray).pick.apply(r,a(e).concat([this.timePoint]));this.floatPixelData=(0,u.default)(s,this.volume.metaData.dataType.OriginalTypedArrayConstructor)}}},{key:I,value:function(t){var e=void 0,i=void 0,n=void 0;switch(t){case"x":e="xyz".indexOf("z"),i="xyz".indexOf("y"),n="xyz".indexOf("x");break;case"y":e="xyz".indexOf("z"),i="xyz".indexOf("x"),n="xyz".indexOf("y");break;case"z":e="xyz".indexOf("y"),i="xyz".indexOf("x"),n="xyz".indexOf("z")}return{rowsIndex:e,columnsIndex:i,framesIndex:n}}},{key:v,value:function(t,e,i){var n=[t[0][e],t[1][e],t[2][e]],a=[t[0][i],t[1][i],t[2][i]];return{rowCosines:(0,m.default)(n),columnCosines:(0,m.default)(a)}}},{key:b,value:function(t,e){var i=(0,f.default)([this.index,0,0],e);return(0,c.default)(t,i).slice(0,3)}},{key:"cornerstoneImageObject",get:function(){var t=this,e=this.volume.metaData,i=this.metaData,n=o.external.cornerstone,a=e.dataType.isDataInColors?n.renderColorImage:n.renderGrayscaleImage;return{imageId:this.imageIdObject.url,color:e.dataType.isDataInColors,columnPixelSpacing:i.columnPixelSpacing,columns:i.columns,height:i.rows,intercept:e.intercept,invert:!1,minPixelValue:e.minPixelValue,maxPixelValue:e.maxPixelValue,rowPixelSpacing:i.rowPixelSpacing,rows:i.rows,sizeInBytes:this.pixelData.byteLength,slope:e.slope,width:i.columns,windowCenter:e.windowCenter,windowWidth:e.windowWidth,floatPixelData:this.floatPixelData,decodeTimeInMS:0,getPixelData:function(){return t.pixelData},render:a}}},{key:"compoundMetaData",get:function(){return Object.assign({},this.volume.metaData,this.metaData)}}]),t}();e.default=y},function(t,e,i){"use strict";function n(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Array,i=new e(t.size),n=0,a=0;a<t.shape[1];++a)for(var r=0;r<t.shape[0];++r)i[n++]=t.get(r,a);return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,i){"use strict";function n(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e-- >0;)t.unshift(t.pop());return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,i){"use strict";function n(t,e){var i=t[0][0],n=t[0][1],a=t[0][2],r=t[0][3],s=t[1][0],o=t[1][1],l=t[1][2],u=t[1][3],h=t[2][0],f=t[2][1],d=t[2][2],c=t[2][3],_=t[3][0],m=t[3][1],p=t[3][2],g=t[3][3],I=e[0],v=e[1],b=e[2],y=e[3]||1;return[I*i+v*n+b*a+y*r,I*s+v*o+b*l+y*u,I*h+v*f+b*d+y*c,I*_+v*m+b*p+y*g]}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,i){"use strict";function n(t,e){return t+e*e}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.reduce(n,0),i=Math.sqrt(e);return 0===i&&(i=1),t.map(function(t){return t/i})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,i){"use strict";function n(t){for(var e=new Array(t),i=0;i<t;++i)e[i]=i;return e}t.exports=n},function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function n(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(i(t)||n(t)||!!t._isBuffer)}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(){n(this,t),this.volumeEntries={},this.cacheUses=0}return a(t,[{key:"add",value:function(t,e){var i=t.filePath;this.volumeEntries[i]=new s(e)}},{key:"get",value:function(t){var e=t.filePath,i=this.volumeEntries[e];if(i)return i.lastUseIndex=this.cacheUses++,i.volume}}]),t}();e.default=r;var s=function t(e){n(this,t),this.volume=e,this.sizeInBytes=e.sizeInBytes,this.lastUseIndex=-1}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,i,n){return function(a){var r=a.loaded,o=void 0,l=void 0;a.lengthComputable&&(o=a.total,l=Math.round(r/o*100)),s(i.onprogress,a,n);var u={url:t,imageId:e,loaded:r,total:o,percentComplete:l};h.default.imageLoadProgress(u)}}function r(t,e){return function(i){if(s(t.onreadystatechange,i,e),!t.onreadystatechange&&(2===this.readyState&&t.onHeadersReceived&&t.onHeadersReceived(this,t,e),4===this.readyState))if([200,206].includes(this.status))e.deferred.resolve(this.response);else{var n="Could not fetch the file '"+e.url+"'. Error code was "+this.status+".";e.deferred.reject(new Error(n))}}}function s(t,e,i){t&&t(e,i)}function o(){}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(14),h=function(t){return t&&t.__esModule?t:{default:t}}(u),f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.method,a=void 0===i?"GET":i,r=e.responseType,s=void 0===r?"arraybuffer":r,l=e.beforeSend,u=void 0===l?o:l,h=e.headers,f=void 0===h?{}:h,d=e.onHeadersReceived,c=void 0===d?o:d;n(this,t),this.options={method:a,responseType:s,beforeSend:u,headers:f,onHeadersReceived:c},this.promisesCache={}}return l(t,[{key:"fetch",value:function(t){var e=this,i=this.getFetchPromiseFromCache(t),n=void 0;return i?n=i.promise:(n=new Promise(function(i,n){var s=new XMLHttpRequest,o={deferred:{resolve:i,reject:n},url:t.filePath,imageId:t.url};s.open(e.options.method,t.filePath,!0),s.responseType=e.options.responseType,"function"==typeof e.options.beforeSend&&e.options.beforeSend(s,t.url),Object.keys(e.options.headers).forEach(function(t){s.setRequestHeader(t,e.options.headers[t])}),s.addEventListener("readystatechange",r(e.options,o)),s.addEventListener("progress",a(t.filePath,t.url,e.options,o)),s.send()}),this.addFetchPromiseToCache(n,t)),n}},{key:"getFetchPromiseFromCache",value:function(t){var e=this,i=this.promisesCache[t.filePath];return Array.isArray(i)&&i.find(function(t){return t.fetcher===e})}},{key:"addFetchPromiseToCache",value:function(t,e){this.promisesCache[e.filePath]=this.promisesCache[e.filePath]||[],this.promisesCache[e.filePath].unshift(new d(this,e,t))}}]),t}();e.default=f;var d=function t(e,i,a){n(this,t),this.fetcher=e,this.imageIdObject=i,this.promise=a}},function(t,e,i){"use strict";function n(t,e){var i=r.nifti,n=t;if(i.isCompressed(t)&&(n=i.decompress(t)),!i.isNIFTI(n))throw new Error("The file '"+e.filePath+"' is not a valid NIFTI file.");return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;var a=i(1),r={nifti:a.external.niftiReader}},function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t){var e=d.external.niftiReader,i=e.readHeader(t);s(e,i);var n=i.scl_inter,a=0===i.scl_slope?1:i.scl_slope,r=i.cal_max-i.cal_min,c=0===r,_=c?void 0:i.cal_min,m=c?void 0:i.cal_max,p=i.dims.slice(1,4),g=i.dims[0]>3?i.dims[4]:1,I={TypedArrayConstructor:l(e,i.datatypeCode),samplesPerPixel:f(i.dims),isDataInFloat:u(e,i.datatypeCode),isDataInColors:h(e,i.dims,i.datatypeCode)},v=i.pixDims.slice(1,4),b=o(i);return{slope:a,intercept:n,windowMinimumValue:_,windowMaximumValue:m,isWindowInfoAbsent:c,voxelLength:p,timeSlices:g,dataType:I,pixelSpacing:v,orientationMatrix:b,orientationString:i.convertNiftiSFormToNEMA(b),header:i}}function r(t,e){var i=d.external.niftiReader;e||(e=a(t));var n=e.dataType.TypedArrayConstructor,r=i.readImage(e.header,t),s=new n(r);return e.header.littleEndian||(s=(0,_.default)(e.header.datatypeCode,s)),{metaData:e,imageData:s}}function s(t,e){var i=void 0;switch(7&e.xyzt_units){case t.NIFTI1.UNITS_METER:i=1e3;break;case t.NIFTI1.UNITS_MICRON:i=.001;break;case t.NIFTI1.UNITS_MM:default:i=1}e.pixDims=e.pixDims.map(function(t,n){return n>0&&n<=e.dims[0]?t*i:t}),e.affine&&(e.affine=e.affine.map(function(t){return t.map(function(t){return t*i})})),(e.quatern_b||e.quatern_c||e.quatern_d)&&(e.quatern_b*=i,e.quatern_c*=i,e.quatern_d*=i),(e.qoffset_x||e.qoffset_y||e.qoffset_z)&&(e.qoffset_x*=i,e.qoffset_y*=i,e.qoffset_z*=i)}function o(t){if(t.affine&&t.sform_code>0)return t.affine;if(t.qform_code>0)return t.convertNiftiQFormToNiftiSForm(t.quatern_b,t.quatern_c,t.quatern_d,t.qoffset_x,t.qoffset_y,t.qoffset_z,t.pixDims[1],t.pixDims[2],t.pixDims[3],t.pixDims[0]);var e={x:t.pixDims[1],y:t.pixDims[2],z:t.pixDims[3]},i={x:-e.x*t.dims[1]/2,y:-e.y*t.dims[2]/2,z:-e.z*t.dims[3]/2};return[[e.x,0,0,i.x],[0,e.y,0,i.y],[0,0,e.z,i.z],[0,0,0,1]]}function l(t,e){var i;return(i={},n(i,t.NIFTI1.TYPE_UINT8,Uint8Array),n(i,t.NIFTI1.TYPE_UINT16,Uint16Array),n(i,t.NIFTI1.TYPE_UINT32,Uint32Array),n(i,t.NIFTI1.TYPE_INT8,Int8Array),n(i,t.NIFTI1.TYPE_INT16,Int16Array),n(i,t.NIFTI1.TYPE_INT32,Int32Array),n(i,t.NIFTI1.TYPE_FLOAT32,Float32Array),n(i,t.NIFTI1.TYPE_FLOAT64,Float64Array),n(i,t.NIFTI1.TYPE_RGB,Uint8Array),n(i,t.NIFTI1.TYPE_RGBA,Uint8Array),i)[e]}function u(t,e){var i;return(i={},n(i,t.NIFTI1.TYPE_UINT8,!1),n(i,t.NIFTI1.TYPE_UINT16,!1),n(i,t.NIFTI1.TYPE_UINT32,!1),n(i,t.NIFTI1.TYPE_INT8,!1),n(i,t.NIFTI1.TYPE_INT16,!1),n(i,t.NIFTI1.TYPE_INT32,!1),n(i,t.NIFTI1.TYPE_FLOAT32,!0),n(i,t.NIFTI1.TYPE_FLOAT64,!0),n(i,t.NIFTI1.TYPE_RGB,!1),n(i,t.NIFTI1.TYPE_RGBA,!1),i)[e]}function h(t,e,i){var a,r=f(e);return(a={},n(a,t.NIFTI1.TYPE_UINT8,!1),n(a,t.NIFTI1.TYPE_UINT16,!1),n(a,t.NIFTI1.TYPE_UINT32,!1),n(a,t.NIFTI1.TYPE_INT8,!1),n(a,t.NIFTI1.TYPE_INT16,!1),n(a,t.NIFTI1.TYPE_INT32,!1),n(a,t.NIFTI1.TYPE_FLOAT32,!1),n(a,t.NIFTI1.TYPE_FLOAT64,!1),n(a,t.NIFTI1.TYPE_RGB,3===r),n(a,t.NIFTI1.TYPE_RGBA,4===r),a)[i]}function f(t){return t[0]>=5?t[5]:1}Object.defineProperty(e,"__esModule",{value:!0}),e.parseNiftiHeader=a,e.parseNiftiFile=r;var d=i(1),c=i(43),_=function(t){return t&&t.__esModule?t:{default:t}}(c)},function(t,e,i){"use strict";function n(t,e){var i=c.external.niftiReader;switch(t){case i.NIFTI1.TYPE_INT16:case i.NIFTI1.TYPE_UINT16:e=a(e);break;case i.NIFTI1.TYPE_RGB24:e=r(e);break;case i.NIFTI1.TYPE_INT32:case i.NIFTI1.TYPE_FLOAT32:case i.NIFTI1.TYPE_UINT32:e=s(e);break;case i.NIFTI1.TYPE_COMPLEX64:case i.NIFTI1.TYPE_FLOAT64:case i.NIFTI1.TYPE_INT64:case i.NIFTI1.TYPE_UINT64:e=o(e);break;case i.NIFTI1.TYPE_FLOAT128:case i.NIFTI1.TYPE_COMPLEX128:e=l(e);break;case i.NIFTI1.TYPE_COMPLEX256:e=u(e)}return e}function a(t){for(var e=0;e<t.length;e++)t[e]=h(t[e]);return t}function r(t){return t}function s(t){for(var e=0;e<t.length;e++)t[e]=f(t[e]);return t}function o(t){for(var e=0;e<t.length;e++)t[e]=d(t[e]);return t}function l(t){return t}function u(t){return t}function h(t){return t>>8&255|t<<8&65280}function f(t){return t>>24&255|t>>8&65280|t<<8&16711680|t<<24&4278190080}function d(t){return t>>56&255|t>>40&65280|t>>24&16711680|t>>8&4278190080|t<<8&0xff00000000|t<<24&0xff0000000000|t<<40&0xff000000000000|t<<56&0xff00000000000000}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;var c=i(1)},function(t,e,i){"use strict";function n(t,e,i){return(t-i)/e}function a(t,e){for(var i=Math.pow(2,16)-1,a=e.minPixelValue,r=e.maxPixelValue,o=r-a,l=0===o?1:o/i,u=a,h=(0,s.default)(new Uint16Array(t.data.length),t.shape,t.stride,t.offset),f=0;f<t.shape[3];f++)for(var d=0;d<t.shape[2];d++)for(var c=0;c<t.shape[1];c++)for(var _=0;_<t.shape[0];_++){var m=t.get(_,c,d,f);m=n(m,l,u),h.set(_,c,d,f,Math.floor(m))}return{convertedImageDataView:h,floatImageDataView:t,metaData:{slope:l,intercept:u,minPixelValue:Math.floor(n(e.minPixelValue,l,u)),maxPixelValue:Math.floor(n(e.maxPixelValue,l,u)),dataType:{TypedArrayConstructor:Uint16Array,OriginalTypedArrayConstructor:e.dataType.TypedArrayConstructor,isDataInFloat:!0,isDataInColors:e.dataType.isDataInColors}}}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var r=i(5),s=function(t){return t&&t.__esModule?t:{default:t}}(r)},function(t,e,i){"use strict";function n(t){for(var e=t.get(0,0,0,0),i=e,n=0;n<t.shape[3];n++)for(var a=0;a<t.shape[2];a++)for(var r=0;r<t.shape[1];r++)for(var s=0;s<t.shape[0];s++){var o=t.get(s,r,a,n);o<e?e=o:o>i&&(i=o)}return{min:e,max:i}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,i){"use strict";function n(t){if("function"!=typeof t.state){var e="pending";t.then(function(t){return e="resolved",t},function(t){return e="rejected",t}),t.state=function(){return e}}return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}])});
//# sourceMappingURL=cornerstoneNIFTIImageLoader.min.js.map